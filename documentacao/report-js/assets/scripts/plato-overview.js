$(function(){"use strict";function t(){$(".js-file-chart").each(function(){var t=$(this),e=t.width()-130;t.empty();var i=t.data("complexity");t.append(o(i,Math.min(2*i,e),"complexity",[5,10])),i=t.data("sloc"),t.append(o(i,Math.min(i,e),"sloc",[400,600])),i=t.data("bugs"),t.append(o(i,Math.min(5*i,e),"est errors",[1,5])),__options.flags.jshint&&(i=t.data("lint"),t.append(o(i,Math.min(5*i,e),"lint errors",[1,10])))})}function e(t){function e(t){(!t||isNaN(t))&&(t=__report.reports.length-1),document.location=__report.reports[t].info.link}var i={element:"chart_maintainability",data:[],xkey:"label",ykeys:["value"],ymax:100,ymin:0,labels:["Maintainability"],barColors:["#ff9b40"]},n={element:"chart_sloc",data:[],xkey:"label",ykeys:["value"],ymax:400,labels:["Lines"],barColors:["#1f6b75"]},r={element:"chart_bugs",data:[],xkey:"label",ykeys:["value"],labels:["Errors"],ymax:20,barColors:["#ff9b40"]},o={element:"chart_lint",data:[],xkey:"label",ykeys:["value"],labels:["Errors"],ymax:20,barColors:["#1f6b75"]};t.forEach(function(t){n.ymax=Math.max(n.ymax,t.complexity.aggregate.complexity.sloc.physical),r.ymax=Math.max(r.ymax,t.complexity.aggregate.complexity.halstead.bugs.toFixed(2)),n.data.push({value:t.complexity.aggregate.complexity.sloc.physical,label:t.info.fileShort}),r.data.push({value:t.complexity.aggregate.complexity.halstead.bugs.toFixed(2),label:t.info.fileShort}),i.data.push({value:t.complexity.maintainability?t.complexity.maintainability.toFixed(2):0,label:t.info.fileShort}),o.data.push({value:t.jshint&&t.jshint.messages,label:t.info.fileShort})});var a=[Morris.Bar(r),Morris.Bar(n),Morris.Bar(i)];return __options.flags.jshint&&a.push(Morris.Bar(o)),a.forEach(function(t){t.on("click",e)}),a}function i(t){var e=_.map(t,function(t){var e=new Date(t.date);return{date:e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),average_maintainability:parseFloat(t.average.maintainability),average_sloc:t.average.sloc}}).slice(-20);Morris.Line({element:"chart_historical_sloc",data:e,xkey:"date",ykeys:["average_sloc"],labels:["Average Lines"],parseTime:!1}),Morris.Line({element:"chart_historical_maint",data:e,xkey:"date",ykeys:["average_maintainability"],labels:["Maintainability"],ymax:100,parseTime:!1})}function n(){$(".js-chart").empty(),i(__history),e(__report.reports),t(__report.reports)}$("[rel=popover]").popover();var r=_.template('<div class="threshold-<%= threshold %>"><label><%= label %></label><span class="horizontal-bar" style="width:<%= width %>px"></span><span class="chart-value"><%= value %></span></div>'),o=function(t,e,i,n){for(var o=0,a=n.length-1;a>-1;a--)if(t>n[a]){o=a+1;break}return r({width:e,label:i,threshold:o,value:t})};n(),$(window).on("resize",_.debounce(n,200))});