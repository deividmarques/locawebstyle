window.CodeMirror=function(){"use strict";function t(r,o){if(!(this instanceof t))return new t(r,o);this.options=o=o||{};for(var s in tr)!o.hasOwnProperty(s)&&tr.hasOwnProperty(s)&&(o[s]=tr[s]);u(o);var c=this.display=e(r);c.wrapper.CodeMirror=this,l(this),o.autofocus&&!Yn&&Q(this),this.view=i(new Li([new Ti([yi("",null,R(c))])])),this.nextOpId=0,n(this),a(this),o.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),this.setValue(o.value||""),En&&setTimeout(on(J,this,!0),20),this.view.history=Bi(),ee(this);var d;try{d=document.activeElement==c.input}catch(f){}d||o.autofocus&&!Yn?setTimeout(on(ye,this),20):_e(this),U(this,function(){for(var t in Qn)Qn.propertyIsEnumerable(t)&&Qn[t](this,o[t],er);for(var e=0;e<or.length;++e)or[e](this)})()}function e(t){var e={},i=e.input=ln("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none;");i.setAttribute("wrap","off"),i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","off"),e.inputDiv=ln("div",[i],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),e.scrollbarH=ln("div",[ln("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),e.scrollbarV=ln("div",[ln("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),e.scrollbarFiller=ln("div",null,"CodeMirror-scrollbar-filler"),e.lineDiv=ln("div"),e.selectionDiv=ln("div",null,null,"position: relative; z-index: 1"),e.cursor=ln("pre","\xa0","CodeMirror-cursor"),e.otherCursor=ln("pre","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"),e.measure=ln("div",null,"CodeMirror-measure"),e.lineSpace=ln("div",[e.measure,e.selectionDiv,e.lineDiv,e.cursor,e.otherCursor],null,"position: relative; outline: none"),e.mover=ln("div",[ln("div",[e.lineSpace],"CodeMirror-lines")],null,"position: relative"),e.sizer=ln("div",[e.mover],"CodeMirror-sizer"),e.heightForcer=ln("div","\xa0",null,"position: absolute; height: "+dr+"px"),e.gutters=ln("div",null,"CodeMirror-gutters"),e.lineGutter=null;var n=ln("div",[e.sizer,e.heightForcer,e.gutters],null,"position: relative; min-height: 100%");return e.scroller=ln("div",[n],"CodeMirror-scroll"),e.scroller.setAttribute("tabIndex","-1"),e.wrapper=ln("div",[e.inputDiv,e.scrollbarH,e.scrollbarV,e.scrollbarFiller,e.scroller],"CodeMirror"),On&&(e.gutters.style.zIndex=-1,e.scroller.style.paddingRight=0),t.appendChild?t.appendChild(e.wrapper):t(e.wrapper),Rn&&(i.style.width="0px"),jn||(e.scroller.draggable=!0),In?(e.inputDiv.style.height="1px",e.inputDiv.style.position="absolute"):On&&(e.scrollbarH.style.minWidth=e.scrollbarV.style.minWidth="18px"),e.viewOffset=e.showingFrom=e.showingTo=e.lastSizeC=0,e.lineNumWidth=e.lineNumInnerWidth=e.lineNumChars=null,e.prevInput="",e.alignWidgets=!1,e.pollingFast=!1,e.poll=new Zi,e.draggingText=!1,e.cachedCharWidth=e.cachedTextHeight=null,e.measureLineCache=[],e.measureLineCachePos=0,e.inaccurateSelection=!1,e.pasteIncoming=!1,e}function i(t){var e={line:0,ch:0};return{doc:t,frontier:0,highlight:new Zi,sel:{from:e,to:e,head:e,anchor:e,shift:!1,extend:!1},scrollTop:0,scrollLeft:0,overwrite:!1,focused:!1,maxLine:Ai(t,0),maxLineLength:0,maxLineChanged:!1,suppressEdits:!1,goalColumn:null,cantEdit:!1,keyMaps:[]}}function n(e){var i=e.view.doc;e.view.mode=t.getMode(e.options,e.options.mode),i.iter(0,i.size,function(t){t.stateAfter=null}),e.view.frontier=0,T(e,100)}function r(t){var e=t.view.doc,i=R(t.display);if(t.options.lineWrapping){t.display.wrapper.className+=" CodeMirror-wrap";var n=t.display.scroller.clientWidth/Y(t.display)-3;e.iter(0,e.size,function(t){if(0!=t.height){var e=Math.ceil(t.text.length/n)||1;1!=e&&Ei(t,e*i)}}),t.display.sizer.style.minWidth=""}else t.display.wrapper.className=t.display.wrapper.className.replace(" CodeMirror-wrap",""),d(t.view),e.iter(0,e.size,function(t){0!=t.height&&Ei(t,i)});q(t,0,e.size),W(t),setTimeout(function(){f(t.display,t.view.doc.height)},100)}function o(t){var e=sr[t.options.keyMap].style;t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(e?" cm-keymap-"+e:"")}function a(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),W(t)}function s(t){l(t),_(t,!0)}function l(t){var e=t.display.gutters,i=t.options.gutters;cn(e);for(var n=0;n<i.length;++n){var r=i[n],o=e.appendChild(ln("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(t.display.lineGutter=o,o.style.width=(t.display.lineNumWidth||1)+"px")}e.style.display=n?"":"none"}function c(t,e){if(0==e.height)return 0;for(var i,n=e.text.length,r=e;i=si(r);){var o=i.find();r=Ai(t,o.from.line),n+=o.from.ch-o.to.ch}for(r=e;i=li(r);){var o=i.find();n-=r.text.length-o.from.ch,r=Ai(t,o.to.line),n+=r.text.length-o.to.ch}return n}function d(t){t.maxLine=Ai(t.doc,0),t.maxLineLength=c(t.doc,t.maxLine),t.maxLineChanged=!0,t.doc.iter(1,t.doc.size,function(e){var i=c(t.doc,e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}function u(t){for(var e=!1,i=0;i<t.gutters.length;++i)"CodeMirror-linenumbers"==t.gutters[i]&&(t.lineNumbers?e=!0:t.gutters.splice(i--,1));!e&&t.lineNumbers&&t.gutters.push("CodeMirror-linenumbers")}function f(t,e){var i=e+2*O(t);t.sizer.style.minHeight=t.heightForcer.style.top=i+"px";var n=Math.max(i,t.scroller.scrollHeight),r=t.scroller.scrollWidth>t.scroller.clientWidth,o=n>t.scroller.clientHeight;o?(t.scrollbarV.style.display="block",t.scrollbarV.style.bottom=r?fn(t.measure)+"px":"0",t.scrollbarV.firstChild.style.height=n-t.scroller.clientHeight+t.scrollbarV.clientHeight+"px"):t.scrollbarV.style.display="",r?(t.scrollbarH.style.display="block",t.scrollbarH.style.right=o?fn(t.measure)+"px":"0",t.scrollbarH.firstChild.style.width=t.scroller.scrollWidth-t.scroller.clientWidth+t.scrollbarH.clientWidth+"px"):t.scrollbarH.style.display="",r&&o?(t.scrollbarFiller.style.display="block",t.scrollbarFiller.style.height=t.scrollbarFiller.style.width=fn(t.measure)+"px"):t.scrollbarFiller.style.display="",zn&&0===fn(t.measure)&&(t.scrollbarV.style.minWidth=t.scrollbarH.style.minHeight=Fn?"18px":"12px")}function p(t,e,i){var n=t.scroller.scrollTop,r=t.wrapper.clientHeight;"number"==typeof i?n=i:i&&(n=i.top,r=i.bottom-i.top),n=Math.floor(n-O(t));var o=Math.ceil(n+r);return{from:Ni(e,n),to:Ni(e,o)}}function h(t){var e=t.display;if(e.alignWidgets||e.gutters.firstChild){for(var i=y(e)-e.scroller.scrollLeft+t.view.scrollLeft,n=e.gutters.offsetWidth,r=i+"px",o=e.lineDiv.firstChild;o;o=o.nextSibling)if(o.alignable)for(var a=0,s=o.alignable;a<s.length;++a)s[a].style.left=r;e.gutters.style.left=i+n+"px"}}function m(t){if(!t.options.lineNumbers)return!1;var e=t.view.doc,i=g(t.options,e.size-1),n=t.display;if(i.length!=n.lineNumChars){var r=n.measure.appendChild(ln("div",[ln("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,a=r.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-a),n.lineNumWidth=n.lineNumInnerWidth+a,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",!0}return!1}function g(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function y(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function _(t,e,i){var n=t.display.showingFrom,r=t.display.showingTo,o=v(t,e,i);return o&&(Ki(t,t,"update",t),(t.display.showingFrom!=n||t.display.showingTo!=r)&&Ki(t,t,"viewportChange",t,t.display.showingFrom,t.display.showingTo)),k(t),f(t.display,t.view.doc.height),o}function v(t,e,i){var n=t.display,r=t.view.doc;if(!n.wrapper.clientWidth)return void(n.showingFrom=n.showingTo=n.viewOffset=0);var o=p(n,r,i);if(!(e!==!0&&0==e.length&&o.from>n.showingFrom&&o.to<n.showingTo)){if(e&&m(t)&&(e=!0),n.sizer.style.marginLeft=n.scrollbarH.style.left=n.gutters.offsetWidth+"px",e!==!0&&Un)for(var a=0;a<e.length;++a)for(var s,l=e[a];s=si(Ai(r,l.from));){var c=s.find().from.line;l.diff&&(l.diff-=l.from-c),l.from=c}var d=e===!0?0:1/0;if(t.options.lineNumbers&&e&&e!==!0)for(var a=0;a<e.length;++a)if(e[a].diff){d=e[a].from;break}var c=Math.max(o.from-t.options.viewportMargin,0),u=Math.min(r.size,o.to+t.options.viewportMargin);if(n.showingFrom<c&&c-n.showingFrom<20&&(c=n.showingFrom),n.showingTo>u&&n.showingTo-u<20&&(u=Math.min(r.size,n.showingTo)),Un)for(c=Oi(ci(r,Ai(r,c)));u<r.size&&di(Ai(r,u));)++u;for(var f=e===!0?[]:b([{from:n.showingFrom,to:n.showingTo}],e),h=0,a=0;a<f.length;++a){var g=f[a];g.from<c&&(g.from=c),g.to>u&&(g.to=u),g.from>=g.to?f.splice(a--,1):h+=g.to-g.from}if(h!=u-c||c!=n.showingFrom||u!=n.showingTo){f.sort(function(t,e){return t.from-e.from}),.7*(u-c)>h&&(n.lineDiv.style.display="none"),w(t,c,u,f,d),n.lineDiv.style.display="";var y=c!=n.showingFrom||u!=n.showingTo||n.lastSizeC!=n.wrapper.clientHeight;y&&(n.lastSizeC=n.wrapper.clientHeight),n.showingFrom=c,n.showingTo=u,T(t,100);for(var _,v=n.lineDiv.offsetTop,x=n.lineDiv.firstChild;x;x=x.nextSibling)if(x.lineObj){if(On){var C=x.offsetTop+x.offsetHeight;_=C-v,v=C}else{var k=x.getBoundingClientRect();_=k.bottom-k.top}var S=x.lineObj.height-_;2>_&&(_=R(n)),(S>.001||-.001>S)&&Ei(x.lineObj,_)}return n.viewOffset=ji(t,Ai(r,c)),n.mover.style.top=n.viewOffset+"px",!0}}}function b(t,e){for(var i=0,n=e.length||0;n>i;++i){for(var r=e[i],o=[],a=r.diff||0,s=0,l=t.length;l>s;++s){var c=t[s];r.to<=c.from&&r.diff?o.push({from:c.from+a,to:c.to+a}):r.to<=c.from||r.from>=c.to?o.push(c):(r.from>c.from&&o.push({from:c.from,to:r.from}),r.to<c.to&&o.push({from:r.to+a,to:c.to+a}))}t=o}return t}function x(t){for(var e=t.display,i={},n={},r=e.gutters.firstChild,o=0;r;r=r.nextSibling,++o)i[t.options.gutters[o]]=r.offsetLeft,n[t.options.gutters[o]]=r.offsetWidth;return{fixedPos:y(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:e.wrapper.clientWidth}}function w(t,e,i,n,r){function o(e){var i=e.nextSibling;return jn&&Vn&&t.display.currentWheelTarget==e?(e.style.display="none",e.lineObj=null):c.removeChild(e),i}var a=x(t),s=t.display,l=t.options.lineNumbers;n.length||En||jn&&t.display.currentWheelTarget||cn(s.lineDiv);var c=s.lineDiv,d=c.firstChild,u=n.shift(),f=e;for(t.view.doc.iter(e,i,function(e){if(u&&u.to==f&&(u=n.shift()),di(e))0!=e.height&&Ei(e,0);else if(u&&u.from<=f&&u.to>f){for(;d.lineObj!=e;)d=o(d);l&&f>=r&&d.lineNumber&&un(d.lineNumber,g(t.options,f)),d=d.nextSibling}else{var i=C(t,e,f,a);c.insertBefore(i,d),i.lineObj=e}++f});d;)d=o(d)}function C(t,e,i,n){var r=Ci(t,e),o=e.gutterMarkers,a=t.display;if(!(t.options.lineNumbers||o||e.bgClass||e.wrapClass||e.widgets&&e.widgets.length))return r;var s=ln("div",null,e.wrapClass,"position: relative");if(t.options.lineNumbers||o){var l=s.appendChild(ln("div",null,null,"position: absolute; left: "+n.fixedPos+"px"));if(s.alignable=[l],!t.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(s.lineNumber=l.appendChild(ln("div",g(t.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.lineNumInnerWidth+"px"))),o)for(var c=0;c<t.options.gutters.length;++c){var d=t.options.gutters[c],u=o.hasOwnProperty(d)&&o[d];u&&l.appendChild(ln("div",[u],"CodeMirror-gutter-elt","left: "+n.gutterLeft[d]+"px; width: "+n.gutterWidth[d]+"px"))}}if(e.bgClass&&s.appendChild(ln("div","\xa0",e.bgClass+" CodeMirror-linebackground")),s.appendChild(r),e.widgets)for(var f=0,p=e.widgets;f<p.length;++f){var h=p[f],m=ln("div",[h.node],"CodeMirror-linewidget");if(m.widget=h,h.noHScroll){(s.alignable||(s.alignable=[])).push(m);var y=n.wrapperWidth;m.style.left=n.fixedPos+"px",h.coverGutter||(y-=n.gutterTotalWidth,m.style.paddingLeft=n.gutterTotalWidth+"px"),m.style.width=y+"px"}h.coverGutter&&(m.style.zIndex=5,m.style.position="relative",h.noHScroll||(m.style.marginLeft=-n.gutterTotalWidth+"px")),h.above?s.insertBefore(m,t.options.lineNumbers&&0!=e.height?l:r):s.appendChild(m)}return On&&(s.style.zIndex=2),s}function k(t){var e=t.display,i=Se(t.view.sel.from,t.view.sel.to);i||t.options.showCursorWhenSelecting?S(t):e.cursor.style.display=e.otherCursor.style.display="none",i?e.selectionDiv.style.display="none":D(t);var n=z(t,t.view.sel.head,"div"),r=e.wrapper.getBoundingClientRect(),o=e.lineDiv.getBoundingClientRect();e.inputDiv.style.top=Math.max(0,Math.min(e.wrapper.clientHeight-10,n.top+o.top-r.top))+"px",e.inputDiv.style.left=Math.max(0,Math.min(e.wrapper.clientWidth-10,n.left+o.left-r.left))+"px"}function S(t){var e=t.display,i=z(t,t.view.sel.head,"div");e.cursor.style.left=i.left+"px",e.cursor.style.top=i.top+"px",e.cursor.style.height=Math.max(0,i.bottom-i.top)*t.options.cursorHeight+"px",e.cursor.style.display="",i.other?(e.otherCursor.style.display="",e.otherCursor.style.left=i.other.left+"px",e.otherCursor.style.top=i.other.top+"px",e.otherCursor.style.height=.85*(i.other.bottom-i.other.top)+"px"):e.otherCursor.style.display="none"}function D(t){function e(t,e,i,n){0>e&&(e=0),a.appendChild(ln("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px; top: "+e+"px; width: "+(null==i?s-t:i)+"px; height: "+(n-e)+"px"))}function i(i,n,o,a){function c(e){return I(t,{line:i,ch:e},"div",d)}var d=Ai(r,i),u=d.text.length,f=a?1/0:-1/0;return hn($i(d),n||0,null==o?u:o,function(t,i,r){var d=c("rtl"==r?i-1:t),p=c("rtl"==r?t:i-1),h=d.left,m=p.right;p.top-d.top>3&&(e(h,d.top,null,d.bottom),h=l,d.bottom<p.top&&e(h,d.bottom,null,p.top)),null==o&&i==u&&(m=s),null==n&&0==t&&(h=l),f=a?Math.min(p.top,f):Math.max(p.bottom,f),l+1>h&&(h=l),e(h,p.top,m-h,p.bottom)}),f}var n=t.display,r=t.view.doc,o=t.view.sel,a=document.createDocumentFragment(),s=n.lineSpace.offsetWidth,l=N(t.display);if(o.from.line==o.to.line)i(o.from.line,o.from.ch,o.to.ch);else{for(var c,d,u=Ai(r,o.from.line),f=u,p=[o.from.line,o.from.ch];c=li(f);){var h=c.find();if(p.push(h.from.ch,h.to.line,h.to.ch),h.to.line==o.to.line){p.push(o.to.ch),d=!0;break}f=Ai(r,h.to.line)}if(d)for(var m=0;m<p.length;m+=3)i(p[m],p[m+1],p[m+2]);else{var g,y,_=Ai(r,o.to.line);g=o.from.ch?i(o.from.line,o.from.ch,null,!1):ji(t,u)-n.viewOffset,y=o.to.ch?i(o.to.line,si(_)?null:0,o.to.ch,!0):ji(t,_)-n.viewOffset,y>g&&e(l,g,null,y)}}dn(n.selectionDiv,a),n.selectionDiv.style.display=""}function M(t){var e=t.display;clearInterval(e.blinker);var i=!0;e.cursor.style.visibility=e.otherCursor.style.visibility="",e.blinker=setInterval(function(){e.cursor.offsetHeight&&(e.cursor.style.visibility=e.otherCursor.style.visibility=(i=!i)?"":"hidden")},t.options.cursorBlinkRate)}function T(t,e){t.view.frontier<t.display.showingTo&&t.view.highlight.set(e,on(L,t))}function L(t){var e=t.view,i=e.doc;if(!(e.frontier>=t.display.showingTo)){var n,r=+new Date+t.options.workTime,o=Ve(e.mode,E(t,e.frontier)),a=[];i.iter(e.frontier,Math.min(i.size,t.display.showingTo+500),function(i){return e.frontier>=t.display.showingFrom?(bi(t,i,o)&&e.frontier>=t.display.showingFrom&&(n&&n.end==e.frontier?n.end++:a.push(n={start:e.frontier,end:e.frontier+1})),i.stateAfter=Ve(e.mode,o)):(xi(t,i,o),i.stateAfter=e.frontier%5==0?Ve(e.mode,o):null),++e.frontier,+new Date>r?(T(t,t.options.workDelay),!0):void 0}),a.length&&U(t,function(){for(var t=0;t<a.length;++t)q(this,a[t].start,a[t].end)})()}}function A(t,e){for(var i,n,r=t.view.doc,o=e,a=e-100;o>a;--o){if(0==o)return 0;var s=Ai(r,o-1);if(s.stateAfter)return o;var l=Ji(s.text,null,t.options.tabSize);(null==n||i>l)&&(n=o-1,i=l)}return n}function E(t,e){var i=t.view,n=A(t,e),r=n&&Ai(i.doc,n-1).stateAfter;return r=r?Ve(i.mode,r):Ge(i.mode),i.doc.iter(n,e,function(o){xi(t,o,r);var a=n==e-1||n%5==0||n>=i.showingFrom&&n<i.showingTo;o.stateAfter=a?Ve(i.mode,r):null,++n}),r}function O(t){return t.lineSpace.offsetTop}function N(t){var e=dn(t.measure,ln("pre")).appendChild(ln("span","x"));return e.offsetLeft}function j(t,e,i,n){for(var n=n||$(t,e),r=-1,o=i;;o+=r){var a=n[o];if(a)break;0>r&&0==o&&(r=1)}return{left:i>o?a.right:a.left,right:o>i?a.left:a.right,top:a.top,bottom:a.bottom}}function $(t,e){for(var i=t.display,n=t.display.measureLineCache,r=0;r<n.length;++r){var o=n[r];if(o.text==e.text&&o.markedSpans==e.markedSpans&&i.scroller.clientWidth==o.width)return o.measure}var a=B(t,e),o={text:e.text,width:i.scroller.clientWidth,markedSpans:e.markedSpans,measure:a};return 16==n.length?n[++i.measureLineCachePos%16]=o:n.push(o),a}function B(t,e){var i=t.display,n=rn(e.text.length),r=Ci(t,e,n);if(En&&!On&&!t.options.lineWrapping&&r.childNodes.length>100){for(var o=document.createDocumentFragment(),a=10,s=r.childNodes.length,l=0,c=Math.ceil(s/a);c>l;++l){for(var d=ln("div",null,null,"display: inline-block"),u=0;a>u&&s;++u)d.appendChild(r.firstChild),--s;o.appendChild(d)}r.appendChild(o)}dn(i.measure,r);for(var f,p=i.lineDiv.getBoundingClientRect(),h=[],m=rn(e.text.length),g=r.offsetHeight,l=0;l<n.length;++l)if(f=n[l]){for(var y=f.getBoundingClientRect(),_=Math.max(0,y.top-p.top),v=Math.min(y.bottom-p.top,g),u=0;u<h.length;u+=2){var b=h[u],x=h[u+1];if(!(b>v||_>x)&&(_>=b&&x>=v||b>=_&&v>=x||Math.min(v,x)-Math.max(_,b)>=v-_>>1)){h[u]=Math.min(_,b),h[u+1]=Math.max(v,x);break}}u==h.length&&h.push(_,v),m[l]={left:y.left-p.left,right:y.right-p.left,top:u}}for(var f,l=0;l<m.length;++l)if(f=m[l]){var w=f.top;f.top=h[w],f.bottom=h[w+1]}return m}function W(t){t.display.measureLineCache.length=t.display.measureLineCachePos=0,t.display.cachedCharWidth=t.display.cachedTextHeight=null,t.view.maxLineChanged=!0}function P(t,e,i,n){if(e.widgets)for(var r=0;r<e.widgets.length;++r)if(e.widgets[r].above){var o=e.widgets[r].node.offsetHeight;i.top+=o,i.bottom+=o}if("line"==n)return i;n||(n="local");var a=ji(t,e);if("local"!=n&&(a-=t.display.viewOffset),"page"==n){var s=t.display.lineSpace.getBoundingClientRect();a+=s.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop);var l=s.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft);i.left+=l,i.right+=l}return i.top+=a,i.bottom+=a,i}function I(t,e,i,n){return n||(n=Ai(t.view.doc,e.line)),P(t,n,j(t,n,e.ch),i)}function z(t,e,i,n,r){function o(e,o){var a=j(t,n,e,r);return o?a.left=a.right:a.right=a.left,P(t,n,a,i)}n=n||Ai(t.view.doc,e.line),r||(r=$(t,n));var a=$i(n),s=e.ch;if(!a)return o(s);for(var l,c,d=a[0].level,u=0;u<a.length;++u){var f,p,h=a[u],m=h.level%2;if(h.from<s&&h.to>s)return o(s,m);var g=m?h.to:h.from,y=m?h.from:h.to;if(g==s)p=u&&h.level<(f=a[u-1]).level?o(f.level%2?f.from:f.to-1,!0):o(m&&h.from!=h.to?s-1:s),m==d?l=p:c=p;else if(y==s){var f=u<a.length-1&&a[u+1];if(!m&&f&&f.from==f.to)continue;p=f&&h.level<f.level?o(f.level%2?f.to-1:f.from):o(m?s:s-1,!0),m==d?l=p:c=p}}return d&&!s&&(c=o(a[0].to-1)),l?(c&&(l.other=c),l):c}function F(t,e,i){var n=t.view.doc;if(i+=t.display.viewOffset,0>i)return{line:0,ch:0,outside:!0};var r=Ni(n,i);if(r>=n.size)return{line:n.size-1,ch:Ai(n,n.size-1).text.length};for(0>e&&(e=0);;){var o=Ai(n,r),a=H(t,o,r,e,i),s=li(o);if(!s||a.ch!=_n(o))return a;r=s.find().to.line}}function H(t,e,i,n,r){function o(n){var r=z(t,{line:i,ch:n},"line",e,c);return s=!0,a>r.bottom?Math.max(0,r.left-l):a<r.top?r.left+l:(s=!1,r.left)}var a=r-ji(t,e),s=!1,l=t.display.wrapper.clientWidth,c=$(t,e),d=$i(e),u=e.text.length,f=yn(e),p=_n(e),h=N(t.display),m=o(p);if(n>m)return{line:i,ch:p,outside:s};for(;;){if(d?p==f||p==xn(e,f,1):1>=p-f){for(var g=m-n>n-h,y=g?f:p;hr.test(e.text.charAt(y));)++y;return{line:i,ch:y,after:g,outside:s}}var _=Math.ceil(u/2),v=f+_;if(d){v=f;for(var b=0;_>b;++b)v=xn(e,v,1)}var x=o(v);x>n?(p=v,m=x,s&&(m+=1e3),u-=_):(f=v,h=x,u=_)}}function R(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Cn){Cn=ln("pre");for(var e=0;49>e;++e)Cn.appendChild(document.createTextNode("x")),Cn.appendChild(ln("br"));Cn.appendChild(document.createTextNode("x"))}dn(t.measure,Cn);var i=Cn.offsetHeight/50;return i>3&&(t.cachedTextHeight=i),cn(t.measure),i||1}function Y(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=ln("span","x"),i=ln("pre",[e]);dn(t.measure,i);var n=e.offsetWidth;return n>2&&(t.cachedCharWidth=n),n||10}function V(t){t.curOp?++t.curOp.depth:t.curOp={depth:1,changes:[],delayedCallbacks:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,updateMaxLine:!1,id:++t.nextOpId}}function G(t){var e=t.curOp;if(!--e.depth){t.curOp=null;var i=t.view,n=t.display;if(e.updateMaxLine&&d(i),i.maxLineChanged&&!t.options.lineWrapping){var r=j(t,i.maxLine,i.maxLine.text.length).right;n.sizer.style.minWidth=r+3+dr+"px",i.maxLineChanged=!1}var o,a;if(e.selectionChanged){var s=z(t,i.sel.head);o=Pe(t,s.left,s.top,s.left,s.bottom)}(e.changes.length||o&&null!=o.scrollTop)&&(a=_(t,e.changes,o&&o.scrollTop)),!a&&e.selectionChanged&&k(t),o&&$e(t),e.selectionChanged&&M(t),i.focused&&e.updateInput&&J(t,e.userSelChange),e.textChanged&&qi(t,"change",t,e.textChanged),e.selectionChanged&&qi(t,"cursorActivity",t);for(var l=0;l<e.delayedCallbacks.length;++l)e.delayedCallbacks[l](t)}}function U(t,e){return function(){var i=t||this;V(i);try{var n=e.apply(i,arguments)}finally{G(i)}return n}}function q(t,e,i,n){t.curOp.changes.push({from:e,to:i,diff:n})}function K(t){t.view.pollingFast||t.display.poll.set(t.options.pollInterval,function(){Z(t),t.view.focused&&K(t)})}function X(t){function e(){var n=Z(t);n||i?(t.display.pollingFast=!1,K(t)):(i=!0,t.display.poll.set(60,e))}var i=!1;t.display.pollingFast=!0,t.display.poll.set(20,e)}function Z(t){var e=t.display.input,i=t.display.prevInput,n=t.view,r=n.sel;if(!n.focused||br(e)||te(t))return!1;var o=e.value;if(o==i&&Se(r.from,r.to))return!1;V(t),n.sel.shift=!1;for(var a=0,s=Math.min(i.length,o.length);s>a&&i[a]==o[a];)++a;var l=r.from,c=r.to;a<i.length?l={line:l.line,ch:l.ch-(i.length-a)}:n.overwrite&&Se(l,c)&&!t.display.pasteIncoming&&(c={line:c.line,ch:Math.min(Ai(t.view.doc,c.line).text.length,c.ch+(o.length-a))});var d=t.curOp.updateInput;return be(t,l,c,vr(o.slice(a)),"end",t.display.pasteIncoming?"paste":"input",{from:l,to:c}),t.curOp.updateInput=d,o.length>1e3?e.value=t.display.prevInput="":t.display.prevInput=o,G(t),t.display.pasteIncoming=!1,!0}function J(t,e){var i,n,r=t.view;Se(r.sel.from,r.sel.to)?e&&(t.display.prevInput=t.display.input.value=""):(t.display.prevInput="",i=xr&&(r.sel.to.line-r.sel.from.line>100||(n=t.getSelection()).length>1e3),t.display.input.value=i?"-":n||t.getSelection(),r.focused&&en(t.display.input)),t.display.inaccurateSelection=i}function Q(t){"nocursor"==t.options.readOnly||!En&&document.activeElement==t.display.input||t.display.input.focus()}function te(t){return t.options.readOnly||t.view.cantEdit}function ee(t){function e(){t.view.focused&&setTimeout(on(Q,t),0)}function i(e){t.options.onDragEvent&&t.options.onDragEvent(t,Ii(e))||Hi(e)}function n(){r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,r.input.value=t.getSelection(),en(r.input))}var r=t.display;Gi(r.scroller,"mousedown",U(t,re)),Gi(r.scroller,"dblclick",U(t,zi)),Gi(r.lineSpace,"selectstart",function(t){ie(r,t)||zi(t)}),An||Gi(r.scroller,"contextmenu",function(e){ve(t,e)}),Gi(r.scroller,"scroll",function(){le(t,r.scroller.scrollTop),ce(t,r.scroller.scrollLeft,!0),qi(t,"scroll",t)}),Gi(r.scrollbarV,"scroll",function(){le(t,r.scrollbarV.scrollTop)}),Gi(r.scrollbarH,"scroll",function(){ce(t,r.scrollbarH.scrollLeft)}),Gi(r.scroller,"mousewheel",function(e){de(t,e)}),Gi(r.scroller,"DOMMouseScroll",function(e){de(t,e)}),Gi(r.scrollbarH,"mousedown",e),Gi(r.scrollbarV,"mousedown",e),Gi(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),Gi(window,"resize",function o(){r.cachedCharWidth=r.cachedTextHeight=null,W(t),r.wrapper.parentNode?_(t,!0):Ui(window,"resize",o)}),Gi(r.input,"keyup",U(t,function(e){t.options.onKeyEvent&&t.options.onKeyEvent(t,Ii(e))||16==Vi(e,"keyCode")&&(t.view.sel.shift=!1)})),Gi(r.input,"input",on(X,t)),Gi(r.input,"keydown",U(t,me)),Gi(r.input,"keypress",U(t,ge)),Gi(r.input,"focus",on(ye,t)),Gi(r.input,"blur",on(_e,t)),t.options.dragDrop&&(Gi(r.scroller,"dragstart",function(e){se(t,e)}),Gi(r.scroller,"dragenter",i),Gi(r.scroller,"dragover",i),Gi(r.scroller,"drop",U(t,oe))),Gi(r.scroller,"paste",function(){Q(t),X(t)}),Gi(r.input,"paste",function(){r.pasteIncoming=!0,X(t)}),Gi(r.input,"cut",n),Gi(r.input,"copy",n),In&&Gi(r.sizer,"mouseup",function(){document.activeElement==r.input&&r.input.blur(),Q(t)})}function ie(t,e){for(var i=Ri(e);i!=t.wrapper;i=i.parentNode)if(/\bCodeMirror-(?:line)?widget\b/.test(i.className)||i.parentNode==t.sizer&&i!=t.mover)return!0}function ne(t,e,i){var n=t.display;if(!i){var r=Ri(e);if(r==n.scrollbarH||r==n.scrollbarH.firstChild||r==n.scrollbarV||r==n.scrollbarV.firstChild||r==n.scrollbarFiller)return null}var o,a,s=n.lineSpace.getBoundingClientRect();try{o=e.clientX,a=e.clientY}catch(e){return null}return F(t,o-s.left,a-s.top)}function re(t){function e(t){if("single"==u)return void Ee(r,Le(l,c),t);if(g=Le(l,g),y=Le(l,y),"double"==u){var e=He(Ai(l,t.line).text,t);De(t,g)?Ee(r,e.from,y):Ee(r,g,e.to)}else"triple"==u&&(De(t,g)?Ee(r,y,Le(l,{line:t.line,ch:0})):Ee(r,g,Le(l,{line:t.line+1,ch:0})))}function i(t){var n=++v,s=ne(r,t,!0);if(s)if(Se(s,h)){var c=t.clientY<_.top?-20:t.clientY>_.bottom?20:0;c&&setTimeout(U(r,function(){v==n&&(o.scroller.scrollTop+=c,i(t))}),50)}else{a.focused||ye(r),h=s,e(s);var d=p(o,l);(s.line>=d.to||s.line<d.from)&&setTimeout(U(r,function(){v==n&&i(t)}),150)}}function n(t){v=1/0;var i=ne(r,t);i&&e(i),zi(t),Q(r),Ui(document,"mousemove",b),Ui(document,"mouseup",x)}var r=this,o=r.display,a=r.view,s=a.sel,l=a.doc;if(s.shift=Vi(t,"shiftKey"),ie(o,t))return void(jn||(o.scroller.draggable=!1,setTimeout(function(){o.scroller.draggable=!0},100)));if(!ae(r,t)){var c=ne(r,t);switch(Yi(t)){case 3:return void(An&&ve.call(r,r,t));case 2:return c&&Ee(r,c),setTimeout(on(Q,r),20),void zi(t)}if(!c)return void(Ri(t)==o.scroller&&zi(t));a.focused||ye(r);var d=+new Date,u="single";if(Sn&&Sn.time>d-400&&Se(Sn.pos,c))u="triple",zi(t),setTimeout(on(Q,r),20),Re(r,c.line);else if(kn&&kn.time>d-400&&Se(kn.pos,c)){u="double",Sn={time:d,pos:c},zi(t);var f=He(Ai(l,c.line).text,c);Ee(r,f.from,f.to)}else kn={time:d,pos:c};var h=c;if(r.options.dragDrop&&mr&&!te(r)&&!Se(s.from,s.to)&&!De(c,s.from)&&!De(s.to,c)&&"single"==u){var m=U(r,function(e){jn&&(o.scroller.draggable=!1),a.draggingText=!1,Ui(document,"mouseup",m),Ui(o.scroller,"drop",m),Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)<10&&(zi(e),Ee(r,c),Q(r))});return jn&&(o.scroller.draggable=!0),a.draggingText=m,o.scroller.dragDrop&&o.scroller.dragDrop(),Gi(document,"mouseup",m),void Gi(o.scroller,"drop",m)}zi(t),"single"==u&&Ee(r,Le(l,c));var g=s.from,y=s.to,_=o.wrapper.getBoundingClientRect(),v=0,b=U(r,function(t){En||Yi(t)?i(t):n(t)}),x=U(r,n);Gi(document,"mousemove",b),Gi(document,"mouseup",x)}}function oe(t){var e=this;if(!e.options.onDragEvent||!e.options.onDragEvent(e,Ii(t))){zi(t);var i=ne(e,t,!0),n=t.dataTransfer.files;if(i&&!te(e))if(n&&n.length&&window.FileReader&&window.File)for(var r=n.length,o=Array(r),a=0,s=function(t,n){var s=new FileReader;s.onload=function(){o[n]=s.result,++a==r&&(i=Le(e.view.doc,i),U(e,function(){var t=ke(e,o.join(""),i,i,"paste");Oe(e,i,t)})())},s.readAsText(t)},l=0;r>l;++l)s(n[l],l);else{if(e.view.draggingText&&!De(i,e.view.sel.from)&&!De(e.view.sel.to,i))return e.view.draggingText(t),void(En&&setTimeout(on(Q,e),50));try{var o=t.dataTransfer.getData("Text");if(o){var c=e.view.sel.from,d=e.view.sel.to;Oe(e,i,i),e.view.draggingText&&ke(e,"",c,d,"paste"),e.replaceSelection(o,null,"paste"),Q(e),ye(e)}}catch(t){}}}}function ae(t,e){var i=t.display;try{var n=e.clientX,r=e.clientY}catch(e){return!1}if(n>=Math.floor(i.gutters.getBoundingClientRect().right))return!1;if(zi(e),!Xi(t,"gutterClick"))return!0;var o=i.lineDiv.getBoundingClientRect();if(r>o.bottom)return!0;r-=o.top-i.viewOffset;for(var a=0;a<t.options.gutters.length;++a){var s=i.gutters.childNodes[a];if(s&&s.getBoundingClientRect().right>=n){var l=Ni(t.view.doc,r),c=t.options.gutters[a];Ki(t,t,"gutterClick",t,l,c,e);break}}return!0}function se(t,e){var i=t.getSelection();e.dataTransfer.setData("Text",i),e.dataTransfer.setDragImage&&!Pn&&e.dataTransfer.setDragImage(ln("img"),0,0)}function le(t,e){Math.abs(t.view.scrollTop-e)<2||(t.view.scrollTop=e,An||_(t,[],e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e),t.display.scrollbarV.scrollTop!=e&&(t.display.scrollbarV.scrollTop=e),An&&_(t,[]))}function ce(t,e,i){(i?e==t.view.scrollLeft:Math.abs(t.view.scrollLeft-e)<2)||(t.view.scrollLeft=e,h(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbarH.scrollLeft!=e&&(t.display.scrollbarH.scrollLeft=e))}function de(t,e){var i=e.wheelDeltaX,n=e.wheelDeltaY;if(null==i&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(i=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),n&&Vn&&jn)for(var r=e.target;r!=o;r=r.parentNode)if(r.lineObj){t.display.currentWheelTarget=r;break}var o=t.display.scroller;if(i&&!An&&!Wn&&null!=Kn)return n&&le(t,Math.max(0,Math.min(o.scrollTop+n*Kn,o.scrollHeight-o.clientHeight))),ce(t,Math.max(0,Math.min(o.scrollLeft+i*Kn,o.scrollWidth-o.clientWidth))),zi(e),void(Tn=null);if(n&&null!=Kn){var a=n*Kn,s=t.view.scrollTop,l=s+t.display.wrapper.clientHeight;0>a?s=Math.max(0,s+a-50):l=Math.min(t.view.doc.height,l+a+50),_(t,[],{top:s,bottom:l})}20>qn&&(null==Tn?(Tn=o.scrollLeft,Ln=o.scrollTop,Dn=i,Mn=n,setTimeout(function(){if(null!=Tn){var t=o.scrollLeft-Tn,e=o.scrollTop-Ln,i=e&&Mn&&e/Mn||t&&Dn&&t/Dn;Tn=Ln=null,i&&(Kn=(Kn*qn+i)/(qn+1),++qn)}},200)):(Dn+=i,Mn+=n))}function ue(t,e,i){if("string"==typeof e&&(e=ar[e],!e))return!1;t.display.pollingFast&&Z(t)&&(t.display.pollingFast=!1);var n=t.view,r=n.sel.shift;try{te(t)&&(n.suppressEdits=!0),i&&(n.sel.shift=!1),e(t)}catch(o){if(o!=ur)throw o;return!1}finally{n.sel.shift=r,n.suppressEdits=!1}return!0}function fe(t){var e=t.view.keyMaps.slice(0);return e.push(t.options.keyMap),t.options.extraKeys&&e.unshift(t.options.extraKeys),e}function pe(t,e){function i(){l=!0}var n=Ue(t.options.keyMap),r=n.auto;clearTimeout(Xn),r&&!Ke(e)&&(Xn=setTimeout(function(){Ue(t.options.keyMap)==n&&(t.options.keyMap=r.call?r.call(null,t):r)},50));var o=wr[Vi(e,"keyCode")],a=!1,s=Vn&&(Wn||$n);if(null==o||e.altGraphKey)return!1;Vi(e,"altKey")&&(o="Alt-"+o),Vi(e,s?"metaKey":"ctrlKey")&&(o="Ctrl-"+o),Vi(e,s?"ctrlKey":"metaKey")&&(o="Cmd-"+o);var l=!1,c=fe(t);return a=Vi(e,"shiftKey")?qe("Shift-"+o,c,function(e){return ue(t,e,!0)},i)||qe(o,c,function(e){return"string"==typeof e&&/^go[A-Z]/.test(e)?ue(t,e):void 0},i):qe(o,c,function(e){return ue(t,e)},i),l&&(a=!1),a&&(zi(e),M(t),Nn&&(e.oldKeyCode=e.keyCode,e.keyCode=0)),a}function he(t,e,i){var n=qe("'"+i+"'",fe(t),function(e){return ue(t,e,!0)});return n&&(zi(e),M(t)),n}function me(t){var e=this;if(e.view.focused||ye(e),En&&27==t.keyCode&&(t.returnValue=!1),!e.options.onKeyEvent||!e.options.onKeyEvent(e,Ii(t))){var i=Vi(t,"keyCode");e.view.sel.shift=16==i||Vi(t,"shiftKey");var n=pe(e,t);Wn&&(Jn=n?i:null,n||88!=i||xr||!Vi(t,Vn?"metaKey":"ctrlKey")||e.replaceSelection(""))}}function ge(t){var e=this;if(!e.options.onKeyEvent||!e.options.onKeyEvent(e,Ii(t))){var i=Vi(t,"keyCode"),n=Vi(t,"charCode");if(Wn&&i==Jn)return Jn=null,void zi(t);if(!(Wn&&(!t.which||t.which<10)||In)||!pe(e,t)){var r=String.fromCharCode(null==n?i:n);this.options.electricChars&&this.view.mode.electricChars&&this.options.smartIndent&&!te(this)&&this.view.mode.electricChars.indexOf(r)>-1&&setTimeout(U(e,function(){Ie(e,e.view.sel.to.line,"smart")}),75),he(e,t,r)||X(e)}}}function ye(t){"nocursor"!=t.options.readOnly&&(t.view.focused||(qi(t,"focus",t),t.view.focused=!0,-1==t.display.scroller.className.search(/\bCodeMirror-focused\b/)&&(t.display.scroller.className+=" CodeMirror-focused"),J(t,!0)),K(t),M(t))}function _e(t){t.view.focused&&(qi(t,"blur",t),t.view.focused=!1,t.display.scroller.className=t.display.scroller.className.replace(" CodeMirror-focused","")),clearInterval(t.display.blinker),setTimeout(function(){t.view.focused||(t.view.sel.shift=!1)},150)}function ve(t,e){function i(){if(n.inputDiv.style.position="relative",n.input.style.cssText=s,Nn&&(n.scrollbarV.scrollTop=n.scroller.scrollTop=a),K(t),null!=n.input.selectionStart){clearTimeout(Zn);var e=n.input.value=" "+(Se(r.from,r.to)?"":n.input.value),i=0;n.prevInput=" ",n.input.selectionStart=1,n.input.selectionEnd=e.length,Zn=setTimeout(function o(){" "==n.prevInput&&0==n.input.selectionStart?U(t,ar.selectAll)(t):i++<10?Zn=setTimeout(o,500):J(t)},200)}}var n=t.display,r=t.view.sel,o=ne(t,e),a=n.scroller.scrollTop;if(o&&!Wn){(Se(r.from,r.to)||De(o,r.from)||!De(o,r.to))&&U(t,Oe)(t,o,o);var s=n.input.style.cssText;n.inputDiv.style.position="absolute",n.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",Q(t),J(t,!0),Se(r.from,r.to)&&(n.input.value=n.prevInput=" "),An?(Hi(e),Gi(window,"mouseup",function l(){Ui(window,"mouseup",l),setTimeout(i,20)
})):setTimeout(i,50)}}function be(t,e,i,n,r,o){var a=Gn&&oi(t.view.doc,e,i);if(!a)return xe(t,e,i,n,r,o);for(var s=a.length-1;s>=1;--s)xe(t,a[s].from,a[s].to,[""],o);return a.length?xe(t,a[0].from,a[0].to,n,r,o):void 0}function xe(t,e,i,n,r,o){if(!t.view.suppressEdits){var a=t.view,s=a.doc,l=[];s.iter(e.line,i.line+1,function(t){l.push(hi(t.text,t.markedSpans))});var c=a.sel.from,d=a.sel.to,u=ri(pi(l[0]),pi(tn(l)),e.ch,i.ch,n),f=Ce(t,e,i,u,r,o);return a.history&&Wi(t,e.line,n.length,l,o,c,d,a.sel.from,a.sel.to),f}}function we(t,e){var i=t.view.doc,n=t.view.history,r=("undo"==e?n.done:n.undone).pop();if(r){for(var o={events:[],fromBefore:r.fromAfter,toBefore:r.toAfter,fromAfter:r.fromBefore,toAfter:r.toBefore},a=r.events.length-1;a>=0;a-=1){n.dirtyCounter+="undo"==e?-1:1;var s=r.events[a],l=[],c=s.start+s.added;i.iter(s.start,c,function(t){l.push(hi(t.text,t.markedSpans))}),o.events.push({start:s.start,added:s.old.length,old:l});var d=a?null:{from:r.fromBefore,to:r.toBefore};Ce(t,{line:s.start,ch:0},{line:c-1,ch:Ai(i,c-1).text.length},s.old,d,e)}("undo"==e?n.undone:n.done).push(o)}}function Ce(t,e,i,n,r,o){var a=t.view,s=a.doc,l=t.display;if(!a.suppressEdits){var d=i.line-e.line,u=Ai(s,e.line),f=Ai(s,i.line),p=!1,h=e.line;t.options.lineWrapping||(h=Oi(ci(s,u)),s.iter(h,i.line+1,function(t){return c(s,t)==a.maxLineLength?(p=!0,!0):void 0}));var m=tn(n),g=R(l);if(0==e.ch&&0==i.ch&&""==fi(m)){for(var y=[],_=0,v=n.length-1;v>_;++_)y.push(yi(fi(n[_]),pi(n[_]),g));_i(t,f,f.text,pi(m)),d&&s.remove(e.line,d,t),y.length&&s.insert(e.line,y)}else if(u==f)if(1==n.length)_i(t,u,u.text.slice(0,e.ch)+fi(n[0])+u.text.slice(i.ch),pi(n[0]));else{for(var y=[],_=1,v=n.length-1;v>_;++_)y.push(yi(fi(n[_]),pi(n[_]),g));y.push(yi(fi(m)+u.text.slice(i.ch),pi(m),g)),_i(t,u,u.text.slice(0,e.ch)+fi(n[0]),pi(n[0])),s.insert(e.line+1,y)}else if(1==n.length)_i(t,u,u.text.slice(0,e.ch)+fi(n[0])+f.text.slice(i.ch),pi(n[0])),s.remove(e.line+1,d,t);else{var y=[];_i(t,u,u.text.slice(0,e.ch)+fi(n[0]),pi(n[0])),_i(t,f,fi(m)+f.text.slice(i.ch),pi(m));for(var _=1,v=n.length-1;v>_;++_)y.push(yi(fi(n[_]),pi(n[_]),g));d>1&&s.remove(e.line+1,d-1,t),s.insert(e.line+1,y)}if(t.options.lineWrapping){var b=Math.max(5,l.scroller.clientWidth/Y(l)-3);s.iter(e.line,e.line+n.length,function(t){if(0!=t.height){var e=(Math.ceil(t.text.length/b)||1)*g;e!=t.height&&Ei(t,e)}})}else s.iter(h,e.line+n.length,function(t){var e=c(s,t);e>a.maxLineLength&&(a.maxLine=t,a.maxLineLength=e,a.maxLineChanged=!0,p=!1)}),p&&(t.curOp.updateMaxLine=!0);a.frontier=Math.min(a.frontier,e.line),T(t,400);var x=n.length-d-1;if(q(t,e.line,i.line+1,x),Xi(t,"change")){for(var _=0;_<n.length;++_)"string"!=typeof n[_]&&(n[_]=n[_].text);var w={from:e,to:i,text:n,origin:o};if(t.curOp.textChanged){for(var C=t.curOp.textChanged;C.next;C=C.next);C.next=w}else t.curOp.textChanged=w}var k,S,D={line:e.line+n.length-1,ch:fi(m).length+(1==n.length?e.ch:0)};if(r&&"string"!=typeof r)r.from?(k=r.from,S=r.to):k=S=r;else if("end"==r)k=S=D;else if("start"==r)k=S=e;else if("around"==r)k=e,S=D;else{var M=function(t){if(De(t,e))return t;if(!De(i,t))return D;var n=t.line+x,r=t.ch;return t.line==i.line&&(r+=fi(m).length-(i.ch-(i.line==e.line?e.ch:0))),{line:n,ch:r}};k=M(a.sel.from),S=M(a.sel.to)}return Oe(t,k,S,null,!0),D}}function ke(t,e,i,n,r){if(n||(n=i),De(n,i)){var o=n;n=i,i=o}return be(t,i,n,vr(e),null,r)}function Se(t,e){return t.line==e.line&&t.ch==e.ch}function De(t,e){return t.line<e.line||t.line==e.line&&t.ch<e.ch}function Me(t){return{line:t.line,ch:t.ch}}function Te(t,e){return Math.max(0,Math.min(e,t.size-1))}function Le(t,e){if(e.line<0)return{line:0,ch:0};if(e.line>=t.size)return{line:t.size-1,ch:Ai(t,t.size-1).text.length};var i=e.ch,n=Ai(t,e.line).text.length;return null==i||i>n?{line:e.line,ch:n}:0>i?{line:e.line,ch:0}:e}function Ae(t,e){return e>=0&&e<t.size}function Ee(t,e,i,n){var r=t.view.sel;if(r.shift||r.extend){var o=r.anchor;if(i){var a=De(e,o);a!=De(i,o)?(o=e,e=i):a!=De(e,i)&&(e=i)}Oe(t,o,e,n)}else Oe(t,e,i||e,n);t.curOp.userSelChange=!0}function Oe(t,e,i,n,r){t.view.goalColumn=null;var o=t.view.sel;if((r||!Se(e,o.anchor))&&(e=je(t,e,n,"push"!=r)),(r||!Se(i,o.head))&&(i=je(t,i,n,"push"!=r)),!Se(o.anchor,e)||!Se(o.head,i)){o.anchor=e,o.head=i;var a=De(i,e);o.from=a?i:e,o.to=a?e:i,t.curOp.updateInput=!0,t.curOp.selectionChanged=!0}}function Ne(t){Oe(t,t.view.sel.from,t.view.sel.to,null,"push")}function je(t,e,i,n){var r=t.view.doc,o=!1,a=e,s=i||1;t.view.cantEdit=!1;t:for(;;){var l,c=Ai(r,a.line);if(c.markedSpans){for(var d=0;d<c.markedSpans.length;++d){var u=c.markedSpans[d],f=u.marker;if((null==u.from||(f.inclusiveLeft?u.from<=a.ch:u.from<a.ch))&&(null==u.to||(f.inclusiveRight?u.to>=a.ch:u.to>a.ch))){if(n&&f.clearOnEnter){(l||(l=[])).push(f);continue}if(!f.atomic)continue;var p=f.find()[0>s?"from":"to"];if(Se(p,a)&&(p.ch+=s,p.ch<0?p=p.line?Le(r,{line:p.line-1}):null:p.ch>c.text.length&&(p=p.line<r.size-1?{line:p.line+1,ch:0}:null),!p)){if(o)return n?(t.view.cantEdit=!0,{line:0,ch:0}):je(t,e,i,!0);o=!0,p=e,s=-s}a=p;continue t}}if(l)for(var d=0;d<l.length;++d)l[d].clear()}return a}}function $e(t){var e=t.view,i=Be(t,e.sel.head);if(e.focused){var n=t.display,r=n.sizer.getBoundingClientRect(),o=null;if(i.top+r.top<0?o=!0:i.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null!=o&&!Hn){var a="none"==n.cursor.style.display;a&&(n.cursor.style.display="",n.cursor.style.left=i.left+"px",n.cursor.style.top=i.top-n.viewOffset+"px"),n.cursor.scrollIntoView(o),a&&(n.cursor.style.display="none")}}}function Be(t,e){for(;;){var i=!1,n=z(t,e),r=Pe(t,n.left,n.top,n.left,n.bottom),o=t.view.scrollTop,a=t.view.scrollLeft;if(null!=r.scrollTop&&(le(t,r.scrollTop),Math.abs(t.view.scrollTop-o)>1&&(i=!0)),null!=r.scrollLeft&&(ce(t,r.scrollLeft),Math.abs(t.view.scrollLeft-a)>1&&(i=!0)),!i)return n}}function We(t,e,i,n,r){var o=Pe(t,e,i,n,r);null!=o.scrollTop&&le(t,o.scrollTop),null!=o.scrollLeft&&ce(t,o.scrollLeft)}function Pe(t,e,i,n,r){var o=t.display,a=O(o);i+=a,r+=a;var s=o.scroller.clientHeight-dr,l=o.scroller.scrollTop,c={},d=t.view.doc.height+2*a,u=a+10>i,f=r+a>d-10;l>i?c.scrollTop=u?0:Math.max(0,i):r>l+s&&(c.scrollTop=(f?d:r)-s);var p=o.scroller.clientWidth-dr,h=o.scroller.scrollLeft;e+=o.gutters.offsetWidth,n+=o.gutters.offsetWidth;var m=o.gutters.offsetWidth,g=m+10>e;return h+m>e||g?(g&&(e=0),c.scrollLeft=Math.max(0,e-10-m)):n>p+h-3&&(c.scrollLeft=n+10-p),c}function Ie(t,e,i,n){var r=t.view.doc;if(i||(i="add"),"smart"==i)if(t.view.mode.indent)var o=E(t,e);else i="prev";var a,s=t.options.tabSize,l=Ai(r,e),c=Ji(l.text,null,s),d=l.text.match(/^\s*/)[0];if("smart"==i&&(a=t.view.mode.indent(o,l.text.slice(d.length),l.text),a==ur)){if(!n)return;i="prev"}"prev"==i?a=e?Ji(Ai(r,e-1).text,null,s):0:"add"==i?a=c+t.options.indentUnit:"subtract"==i&&(a=c-t.options.indentUnit),a=Math.max(0,a);var u="",f=0;if(t.options.indentWithTabs)for(var p=Math.floor(a/s);p;--p)f+=s,u+="	";a>f&&(u+=Qi(a-f)),u!=d&&ke(t,u,{line:e,ch:0},{line:e,ch:d.length},"input"),l.stateAfter=null}function ze(t,e,i){var n=e,r=e,o=t.view.doc;return"number"==typeof e?r=Ai(o,Te(o,e)):n=Oi(e),null==n?null:i(r,n)?(q(t,n,n+1),r):null}function Fe(t,e,i,n){function r(){var t=l+e;return 0>t||t==a.size?!1:(l=t,d=Ai(a,t))}function o(t){var i=(n?xn:wn)(d,c,e,!0);if(null==i){if(t||!r())return!1;c=n?(0>e?_n:yn)(d):0>e?d.text.length:0}else c=i;return!0}var a=t.view.doc,s=t.view.sel.head,l=s.line,c=s.ch,d=Ai(a,l);if("char"==i)o();else if("column"==i)o(!0);else if("word"==i)for(var u=!1;!(0>e)||o();){if(an(d.text.charAt(c)))u=!0;else if(u){0>e&&(e=1,o());break}if(e>0&&!o())break}return je(t,{line:l,ch:c},e,!0)}function He(t,e){var i=e.ch,n=e.ch;if(t){e.after===!1||n==t.length?--i:++n;for(var r=t.charAt(i),o=an(r)?an:/\s/.test(r)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!an(t)};i>0&&o(t.charAt(i-1));)--i;for(;n<t.length&&o(t.charAt(n));)++n}return{from:{line:e.line,ch:i},to:{line:e.line,ch:n}}}function Re(t,e){Ee(t,{line:e,ch:0},Le(t.view.doc,{line:e+1,ch:0}))}function Ye(e,i,n,r){t.defaults[e]=i,n&&(Qn[e]=r?function(t,e,i){i!=er&&n(t,e,i)}:n)}function Ve(t,e){if(e===!0)return e;if(t.copyState)return t.copyState(e);var i={};for(var n in e){var r=e[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i}function Ge(t,e,i){return t.startState?t.startState(e,i):!0}function Ue(t){return"string"==typeof t?sr[t]:t}function qe(t,e,i,n){function r(e){e=Ue(e);var o=e[t];if(o===!1)return n&&n(),!0;if(null!=o&&i(o))return!0;if(e.nofallthrough)return n&&n(),!0;var a=e.fallthrough;if(null==a)return!1;if("[object Array]"!=Object.prototype.toString.call(a))return r(a);for(var s=0,l=a.length;l>s;++s)if(r(a[s]))return!0;return!1}for(var o=0;o<e.length;++o)if(r(e[o]))return!0}function Ke(t){var e=wr[Vi(t,"keyCode")];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Xe(t,e){this.pos=this.start=0,this.string=t,this.tabSize=e||8}function Ze(t,e){this.lines=[],this.type=e,this.cm=t}function Je(t,e,i,n,r){var o=t.view.doc,a=new Ze(t,r);if("range"==r&&!De(e,i))return a;if(n)for(var s in n)n.hasOwnProperty(s)&&(a[s]=n[s]);a.replacedWith&&(a.collapsed=!0,a.replacedWith=ln("span",[a.replacedWith],"CodeMirror-widget")),a.collapsed&&(Un=!0);var l,c,d=e.line,u=0;if(o.iter(d,i.line+1,function(t){var n={from:null,to:null,marker:a};u+=t.text.length,d==e.line&&(n.from=e.ch,u-=e.ch),d==i.line&&(n.to=i.ch,u-=t.text.length-i.ch),a.collapsed&&(d==i.line&&(c=ai(t,i.ch)),d==e.line?l=ai(t,e.ch):Ei(t,0)),ei(t,n),a.collapsed&&d==e.line&&di(t)&&Ei(t,0),++d}),a.readOnly&&(Gn=!0,(t.view.history.done.length||t.view.history.undone.length)&&t.clearHistory()),a.collapsed){if(l!=c)throw new Error("Inserting collapsed marker overlapping an existing one");a.size=u,a.atomic=!0}return(a.className||a.startStyle||a.endStyle||a.collapsed)&&q(t,e.line,i.line+1),a.atomic&&Ne(t),a}function Qe(t,e){if(t)for(var i=0;i<t.length;++i){var n=t[i];if(n.marker==e)return n}}function ti(t,e){for(var i,n=0;n<t.length;++n)t[n]!=e&&(i||(i=[])).push(t[n]);return i}function ei(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.lines.push(t)}function ii(t,e){if(t)for(var i,n=0;n<t.length;++n){var r=t[n],o=r.marker,a=null==r.from||(o.inclusiveLeft?r.from<=e:r.from<e);if(a||"bookmark"==o.type&&r.from==e){var s=null==r.to||(o.inclusiveRight?r.to>=e:r.to>e);(i||(i=[])).push({from:r.from,to:s?null:r.to,marker:o})}}return i}function ni(t,e,i){if(t)for(var n,r=0;r<t.length;++r){var o=t[r],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=i:o.to>i);if(s||"bookmark"==a.type&&o.from==i&&o.from!=e){var l=null==o.from||(a.inclusiveLeft?o.from<=i:o.from<i);(n||(n=[])).push({from:l?null:o.from-i,to:null==o.to?null:o.to-i,marker:a})}}return n}function ri(t,e,i,n,r){if(!t&&!e)return r;var o=ii(t,i),a=ni(e,i,n),s=1==r.length,l=tn(r).length+(s?i:0);if(o)for(var c=0;c<o.length;++c){var d=o[c];if(null==d.to){var u=Qe(a,d.marker);u?s&&(d.to=null==u.to?null:u.to+l):d.to=i}}if(a)for(var c=0;c<a.length;++c){var d=a[c];if(null!=d.to&&(d.to+=l),null==d.from){var u=Qe(o,d.marker);u||(d.from=l,s&&(o||(o=[])).push(d))}else d.from+=l,s&&(o||(o=[])).push(d)}var f=[hi(r[0],o)];if(!s){var p,h=r.length-2;if(h>0&&o)for(var c=0;c<o.length;++c)null==o[c].to&&(p||(p=[])).push({from:null,to:null,marker:o[c].marker});for(var c=0;h>c;++c)f.push(hi(r[c+1],p));f.push(hi(tn(r),a))}return f}function oi(t,e,i){var n=null;if(t.iter(e.line,i.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var i=t.markedSpans[e].marker;!i.readOnly||n&&-1!=nn(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var r=[{from:e,to:i}],o=0;o<n.length;++o)for(var a=n[o].find(),s=0;s<r.length;++s){var l=r[s];if(De(a.from,l.to)&&!De(a.to,l.from)){var c=[s,1];De(l.from,a.from)&&c.push({from:l.from,to:a.from}),De(a.to,l.to)&&c.push({from:a.to,to:l.to}),r.splice.apply(r,c),s+=c.length-1}}return r}function ai(t,e){var i,n=Un&&t.markedSpans;if(n)for(var r,o=0;o<n.length;++o)r=n[o],r.marker.collapsed&&(null==r.from||r.from<e)&&(null==r.to||r.to>e)&&(!i||i.width<r.marker.width)&&(i=r.marker);return i}function si(t){return ai(t,-1)}function li(t){return ai(t,t.text.length+1)}function ci(t,e){for(var i;i=si(e);)e=Ai(t,i.find().from.line);return e}function di(t){var e=Un&&t.markedSpans;if(e)for(var i,n=0;n<e.length;++n)if(i=e[n],i.marker.collapsed){if(null==i.from)return!0;if(0==i.from&&i.marker.inclusiveLeft&&ui(t,i))return!0}}function ui(t,e){if(null==e.to||e.marker.inclusiveRight&&e.to==t.text.length)return!0;for(var i,n=0;n<t.markedSpans.length;++n)if(i=t.markedSpans[n],i.marker.collapsed&&i.from==e.to&&(i.marker.inclusiveLeft||e.marker.inclusiveRight)&&ui(t,i))return!0}function fi(t){return"string"==typeof t?t:t.text}function pi(t){if("string"==typeof t)return null;for(var e=t.markedSpans,i=null,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?i||(i=e.slice(0,n)):i&&i.push(e[n]);return i?i.length?i:null:e}function hi(t,e){return e?{text:t,markedSpans:e}:t}function mi(t){var e=t.markedSpans;if(e){for(var i=0;i<e.length;++i){var n=e[i].marker.lines,r=nn(n,t);n.splice(r,1)}t.markedSpans=null}}function gi(t,e){if(e){for(var i=0;i<e.length;++i)e[i].marker.lines.push(t);t.markedSpans=e}}function yi(t,e,i){var n={text:t,height:i};return gi(n,e),di(n)&&(n.height=0),n}function _i(t,e,i,n){e.text=i,e.stateAfter=e.styles=null,null!=e.order&&(e.order=null),mi(e),gi(e,n),di(e)?e.height=0:e.height||(e.height=R(t.display)),Ki(t,e,"change")}function vi(t){t.parent=null,mi(t)}function bi(t,e,i){var n=t.view.mode,r=t.options.flattenSpans,o=!e.styles,a=0,s="",l=null,c=new Xe(e.text,t.options.tabSize),d=e.styles||(e.styles=[]);for(""==e.text&&n.blankLine&&n.blankLine(i);!c.eol();){var u=n.token(c,i),f=c.current();if(c.start=c.pos,r&&l==u?s+=f:(s&&(o=o||a>=d.length||s!=d[a]||l!=d[a+1],d[a++]=s,d[a++]=l),s=f,l=u),c.pos>5e3)break}return s&&(o=o||a>=d.length||s!=d[a]||l!=d[a+1],d[a++]=s,d[a++]=l),c.pos>5e3&&(d[a++]=e.text.slice(c.pos),d[a++]=null),a!=d.length&&(d.length=a,o=!0),o}function xi(t,e,i){var n=t.view.mode,r=new Xe(e.text,t.options.tabSize);for(""==e.text&&n.blankLine&&n.blankLine(i);!r.eol()&&r.pos<=5e3;)n.token(r,i),r.start=r.pos}function wi(t){return t?lr[t]||(lr[t]="cm-"+t.replace(/ +/g," cm-")):null}function Ci(t,e,i){for(var n,r,o,a=e,s=!0;n=si(a);)s=!1,a=Ai(t.view.doc,n.find().from.line),r||(r=a);var l={pre:ln("pre"),col:0,pos:0,display:!i,measure:null,addedOne:!1,cm:t};a.textClass&&(l.pre.className=a.textClass);do{a.styles||bi(t,a,a.stateAfter=E(t,Oi(a))),l.measure=a==e&&i,l.pos=0,l.addToken=l.measure?Si:ki,i&&o&&a!=e&&!l.addedOne&&(i[0]=l.pre.appendChild(pn(t.display.measure)),l.addedOne=!0);var c=Mi(a,l);o=a==r,c&&(a=Ai(t.view.doc,c.to.line),s=!1)}while(c);return i&&!l.addedOne&&(i[0]=l.pre.appendChild(s?ln("span","\xa0"):pn(t.display.measure))),l.pre.firstChild||di(e)||l.pre.appendChild(document.createTextNode("\xa0")),l.pre}function ki(t,e,i,n,r){if(e){if(cr.test(e))for(var o=document.createDocumentFragment(),a=0;;){cr.lastIndex=a;var s=cr.exec(e),l=s?s.index-a:e.length-a;if(l&&(o.appendChild(document.createTextNode(e.slice(a,a+l))),t.col+=l),!s)break;if(a+=l+1,"	"==s[0]){var c=t.cm.options.tabSize,d=c-t.col%c;o.appendChild(ln("span",Qi(d),"cm-tab")),t.col+=d}else{var u=ln("span","\u2022","cm-invalidchar");u.title="\\u"+s[0].charCodeAt(0).toString(16),o.appendChild(u),t.col+=1}}else{t.col+=e.length;var o=document.createTextNode(e)}if(i||n||r||t.measure){var f=i||"";return n&&(f+=n),r&&(f+=r),t.pre.appendChild(ln("span",[o],f))}t.pre.appendChild(o)}}function Si(t,e,i,n,r){for(var o=0;o<e.length;++o)o&&o<e.length-1&&t.cm.options.lineWrapping&&gr.test(e.slice(o-1,o+1))&&t.pre.appendChild(ln("wbr")),t.measure[t.pos++]=ki(t,e.charAt(o),i,0==o&&n,o==e.length-1&&r);e.length&&(t.addedOne=!0)}function Di(t,e,i){i&&(t.display||(i=i.cloneNode(!0)),t.pre.appendChild(i),t.measure&&e&&(t.measure[t.pos]=i,t.addedOne=!0)),t.pos+=e}function Mi(t,e){var i=t.styles,n=t.markedSpans;if(n)for(var r,o,a,s,l,c=t.text,d=c.length,u=0,f=0,p="",h=0;;){if(h==u){o=a=s="",l=null,h=1/0;for(var m=null,g=0;g<n.length;++g){var y=n[g],_=y.marker;y.from<=u&&(null==y.to||y.to>u)?(null!=y.to&&h>y.to&&(h=y.to,a=""),_.className&&(o+=" "+_.className),_.startStyle&&y.from==u&&(s+=" "+_.startStyle),_.endStyle&&y.to==h&&(a+=" "+_.endStyle),_.collapsed&&(!l||l.marker.width<_.width)&&(l=y)):y.from>u&&h>y.from&&(h=y.from),"bookmark"==_.type&&y.from==u&&_.replacedWith&&(m=_.replacedWith)}if(l&&(l.from||0)==u&&(Di(e,(null==l.to?d:l.to)-u,null!=l.from&&l.marker.replacedWith),null==l.to))return l.marker.find();m&&!l&&Di(e,0,m)}if(u>=d)break;for(var v=Math.min(d,h);;){if(p){var b=u+p.length;if(!l){var x=b>v?p.slice(0,v-u):p;e.addToken(e,x,r+o,s,u+x.length==h?a:"")}if(b>=v){p=p.slice(v-u),u=v;break}u=b,s=""}p=i[f++],r=wi(i[f++])}}else for(var f=0;f<i.length;f+=2)e.addToken(e,i[f],wi(i[f+1]))}function Ti(t){this.lines=t,this.parent=null;for(var e=0,i=t.length,n=0;i>e;++e)t[e].parent=this,n+=t[e].height;this.height=n}function Li(t){this.children=t;for(var e=0,i=0,n=0,r=t.length;r>n;++n){var o=t[n];e+=o.chunkSize(),i+=o.height,o.parent=this}this.size=e,this.height=i,this.parent=null}function Ai(t,e){for(;!t.lines;)for(var i=0;;++i){var n=t.children[i],r=n.chunkSize();if(r>e){t=n;break}e-=r}return t.lines[e]}function Ei(t,e){for(var i=e-t.height,n=t;n;n=n.parent)n.height+=i}function Oi(t){if(null==t.parent)return null;for(var e=t.parent,i=nn(e.lines,t),n=e.parent;n;e=n,n=n.parent)for(var r=0;n.children[r]!=e;++r)i+=n.children[r].chunkSize();return i}function Ni(t,e){var i=0;t:do{for(var n=0,r=t.children.length;r>n;++n){var o=t.children[n],a=o.height;if(a>e){t=o;continue t}e-=a,i+=o.chunkSize()}return i}while(!t.lines);for(var n=0,r=t.lines.length;r>n;++n){var s=t.lines[n],l=s.height;if(l>e)break;e-=l}return i+n}function ji(t,e){e=ci(t.view.doc,e);for(var i=0,n=e.parent,r=0;r<n.lines.length;++r){var o=n.lines[r];if(o==e)break;i+=o.height}for(var a=n.parent;a;n=a,a=n.parent)for(var r=0;r<a.children.length;++r){var s=a.children[r];if(s==n)break;i+=s.height}return i}function $i(t){var e=t.order;return null==e&&(e=t.order=Cr(t.text)),e}function Bi(){return{done:[],undone:[],lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function Wi(t,e,i,n,r,o,a,s,l){var c=t.view.history;c.undone.length=0;var d=+new Date,u=tn(c.done);if(u&&(c.lastOp==t.curOp.id||c.lastOrigin==r&&("input"==r||"delete"==r)&&c.lastTime>d-600)){var f=tn(u.events);if(f.start>e+n.length||f.start+f.added<e)u.events.push({start:e,added:i,old:n});else{for(var p=Math.max(0,f.start-e),h=Math.max(0,e+n.length-(f.start+f.added)),m=p;m>0;--m)f.old.unshift(n[m-1]);for(var m=h;m>0;--m)f.old.push(n[n.length-m]);p&&(f.start=e),f.added+=i-(n.length-p-h)}u.fromAfter=s,u.toAfter=l}else{for(u={events:[{start:e,added:i,old:n}],fromBefore:o,toBefore:a,fromAfter:s,toAfter:l},c.done.push(u);c.done.length>t.options.undoDepth;)c.done.shift();c.dirtyCounter<0?c.dirtyCounter=0/0:c.dirtyCounter++}c.lastTime=d,c.lastOp=t.curOp.id,c.lastOrigin=r}function Pi(){Hi(this)}function Ii(t){return t.stop||(t.stop=Pi),t}function zi(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function Fi(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function Hi(t){zi(t),Fi(t)}function Ri(t){return t.target||t.srcElement}function Yi(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),Vn&&t.ctrlKey&&1==e&&(e=3),e}function Vi(t,e){var i=t.override&&t.override.hasOwnProperty(e);return i?t.override[e]:t[e]}function Gi(t,e,i){if(t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent)t.attachEvent("on"+e,i);else{var n=t._handlers||(t._handlers={}),r=n[e]||(n[e]=[]);r.push(i)}}function Ui(t,e,i){if(t.removeEventListener)t.removeEventListener(e,i,!1);else if(t.detachEvent)t.detachEvent("on"+e,i);else{var n=t._handlers&&t._handlers[e];if(!n)return;for(var r=0;r<n.length;++r)if(n[r]==i){n.splice(r,1);break}}}function qi(t,e){var i=t._handlers&&t._handlers[e];if(i)for(var n=Array.prototype.slice.call(arguments,2),r=0;r<i.length;++r)i[r].apply(null,n)}function Ki(t,e,i){function n(t){return function(){t.apply(null,o)}}var r=e._handlers&&e._handlers[i];if(r)for(var o=Array.prototype.slice.call(arguments,3),a=t.curOp&&t.curOp.delayedCallbacks,s=0;s<r.length;++s)a?a.push(n(r[s])):r[s].apply(null,o)}function Xi(t,e){var i=t._handlers&&t._handlers[e];return i&&i.length>0}function Zi(){this.id=null}function Ji(t,e,i){null==e&&(e=t.search(/[^\s\u00a0]/),-1==e&&(e=t.length));for(var n=0,r=0;e>n;++n)"	"==t.charAt(n)?r+=i-r%i:++r;return r}function Qi(t){for(;fr.length<=t;)fr.push(tn(fr)+" ");return fr[t]}function tn(t){return t[t.length-1]}function en(t){Rn?(t.selectionStart=0,t.selectionEnd=t.value.length):t.select()}function nn(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;n>i;++i)if(t[i]==e)return i;return-1}function rn(t){for(var e=[],i=0;t>i;++i)e.push(void 0);return e}function on(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function an(t){return/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||pr.test(t))}function sn(t){var e=0;for(var i in t)t.hasOwnProperty(i)&&t[i]&&++e;return!e}function ln(t,e,i,n){var r=document.createElement(t);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof e)un(r,e);else if(e)for(var o=0;o<e.length;++o)r.appendChild(e[o]);return r}function cn(t){return t.innerHTML="",t}function dn(t,e){return cn(t).appendChild(e)}function un(t,e){Nn?(t.innerHTML="",t.appendChild(document.createTextNode(e))):t.textContent=e}function fn(t){if(null!=yr)return yr;var e=ln("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return dn(t,e),e.offsetWidth&&(yr=e.offsetHeight-e.clientHeight),yr||0}function pn(t){if(null==_r){var e=ln("span","\u200b");dn(t,ln("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(_r=e.offsetWidth<=1&&e.offsetHeight>2&&!On)}return _r?ln("span","\u200b"):ln("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px")}function hn(t,e,i,n){if(!t)return n(e,i,"ltr");for(var r=0;r<t.length;++r){var o=t[r];o.from<i&&o.to>e&&n(Math.max(o.from,e),Math.min(o.to,i),1==o.level?"rtl":"ltr")}}function mn(t){return t.level%2?t.to:t.from}function gn(t){return t.level%2?t.from:t.to}function yn(t){var e=$i(t);return e?mn(e[0]):0}function _n(t){var e=$i(t);return e?gn(tn(e)):t.text.length}function vn(t,e){var i=Ai(t.view.doc,e),n=ci(t.view.doc,i);n!=i&&(e=Oi(n));var r=$i(n),o=r?r[0].level%2?_n(n):yn(n):0;return{line:e,ch:o}}function bn(t,e){for(var i,n;i=li(n=Ai(t.view.doc,e));)e=i.find().to.line;var r=$i(n),o=r?r[0].level%2?yn(n):_n(n):n.text.length;return{line:e,ch:o}}function xn(t,e,i,n){var r=$i(t);if(!r)return wn(t,e,i,n);for(var o=n?function(e,i){do e+=i;while(e>0&&hr.test(t.text.charAt(e)));return e}:function(t,e){return t+e},a=r[0].level,s=0;s<r.length;++s){var l=r[s],c=l.level%2==a;if(l.from<e&&l.to>e||c&&(l.from==e||l.to==e))break}for(var d=o(e,l.level%2?-i:i);null!=d;)if(l.level%2==a){if(!(d<l.from||d>l.to))break;l=r[s+=i],d=l&&(i>0==l.level%2?o(l.to,-1):o(l.from,1))}else if(d==mn(l))l=r[--s],d=l&&gn(l);else{if(d!=gn(l))break;l=r[++s],d=l&&mn(l)}return 0>d||d>t.text.length?null:d}function wn(t,e,i,n){var r=e+i;if(n)for(;r>0&&hr.test(t.text.charAt(r));)r+=i;return 0>r||r>t.text.length?null:r}var Cn,kn,Sn,Dn,Mn,Tn,Ln,An=/gecko\/\d/i.test(navigator.userAgent),En=/MSIE \d/.test(navigator.userAgent),On=/MSIE [1-7]\b/.test(navigator.userAgent),Nn=/MSIE [1-8]\b/.test(navigator.userAgent),jn=/WebKit\//.test(navigator.userAgent),$n=jn&&/Qt\/\d+\.\d+/.test(navigator.userAgent),Bn=/Chrome\//.test(navigator.userAgent),Wn=/Opera\//.test(navigator.userAgent),Pn=/Apple Computer/.test(navigator.vendor),In=/KHTML\//.test(navigator.userAgent),zn=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Fn=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Hn=/PhantomJS/.test(navigator.userAgent),Rn=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Yn=Rn||/Android|webOS|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent),Vn=Rn||/Mac/.test(navigator.platform),Gn=!1,Un=!1,qn=0,Kn=null;En?Kn=-.53:An?Kn=15:Bn?Kn=-.7:Pn&&(Kn=-1/3);var Xn,Zn,Jn=null;t.prototype={getValue:function(t){var e=[],i=this.view.doc;return i.iter(0,i.size,function(t){e.push(t.text)}),e.join(t||"\n")},setValue:U(null,function(t){var e=this.view.doc,i={line:0,ch:0},n=Ai(e,e.size-1).text.length;xe(this,i,{line:e.size-1,ch:n},vr(t),i,i,"setValue")}),getSelection:function(t){return this.getRange(this.view.sel.from,this.view.sel.to,t)},replaceSelection:U(null,function(t,e,i){var n=this.view.sel;be(this,n.from,n.to,vr(t),e||"around",i)}),focus:function(){window.focus(),Q(this),ye(this),X(this)},setOption:function(t,e){var i=this.options,n=i[t];(i[t]!=e||"mode"==t)&&(i[t]=e,Qn.hasOwnProperty(t)&&U(this,Qn[t])(this,e,n))},getOption:function(t){return this.options[t]},getMode:function(){return this.view.mode},addKeyMap:function(t){this.view.keyMaps.push(t)},removeKeyMap:function(t){for(var e=this.view.keyMaps,i=0;i<e.length;++i)if(("string"==typeof t?e[i].name:e[i])==t)return e.splice(i,1),!0},undo:U(null,function(){we(this,"undo")}),redo:U(null,function(){we(this,"redo")}),indentLine:U(null,function(t,e,i){"string"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),Ae(this.view.doc,t)&&Ie(this,t,e,i)}),indentSelection:U(null,function(t){var e=this.view.sel;if(Se(e.from,e.to))return Ie(this,e.from.line,t);for(var i=e.to.line-(e.to.ch?0:1),n=e.from.line;i>=n;++n)Ie(this,n,t)}),historySize:function(){var t=this.view.history;return{undo:t.done.length,redo:t.undone.length}},clearHistory:function(){this.view.history=Bi()},markClean:function(){this.view.history.dirtyCounter=0,this.view.history.lastOp=this.view.history.lastOrigin=null},isClean:function(){return 0==this.view.history.dirtyCounter},getHistory:function(){function t(t){for(var e,i=0,n=[];i<t.length;++i){var r=t[i];n.push({events:e=[],fromBefore:r.fromBefore,toBefore:r.toBefore,fromAfter:r.fromAfter,toAfter:r.toAfter});for(var o=0,a=r.events;o<a.length;++o){var s=[],l=a[o];e.push({start:l.start,added:l.added,old:s});for(var c=0;c<l.old.length;++c)s.push(fi(l.old[c]))}}return n}var e=this.view.history;return{done:t(e.done),undone:t(e.undone)}},setHistory:function(t){var e=this.view.history=Bi();e.done=t.done,e.undone=t.undone},getTokenAt:function(t){var e=this.view.doc;t=Le(e,t);for(var i=E(this,t.line),n=this.view.mode,r=Ai(e,t.line),o=new Xe(r.text,this.options.tabSize);o.pos<t.ch&&!o.eol();){o.start=o.pos;var a=n.token(o,i)}return{start:o.start,end:o.pos,string:o.current(),className:a||null,type:a||null,state:i}},getStateAfter:function(t){var e=this.view.doc;return t=Te(e,null==t?e.size-1:t),E(this,t+1)},cursorCoords:function(t,e){var i,n=this.view.sel;return i=null==t?n.head:"object"==typeof t?Le(this.view.doc,t):t?n.from:n.to,z(this,i,e||"page")},charCoords:function(t,e){return I(this,Le(this.view.doc,t),e||"page")},coordsChar:function(t){var e=this.display.lineSpace.getBoundingClientRect();return F(this,t.left-e.left,t.top-e.top)},defaultTextHeight:function(){return R(this.display)},markText:U(null,function(t,e,i){return Je(this,Le(this.view.doc,t),Le(this.view.doc,e),i,"range")}),setBookmark:U(null,function(t,e){return t=Le(this.view.doc,t),Je(this,t,t,e?{replacedWith:e}:{},"bookmark")}),findMarksAt:function(t){var e=this.view.doc;t=Le(e,t);var i=[],n=Ai(e,t.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var o=n[r];(null==o.from||o.from<=t.ch)&&(null==o.to||o.to>=t.ch)&&i.push(o.marker)}return i},setGutterMarker:U(null,function(t,e,i){return ze(this,t,function(t){var n=t.gutterMarkers||(t.gutterMarkers={});return n[e]=i,!i&&sn(n)&&(t.gutterMarkers=null),!0})}),clearGutter:U(null,function(t){var e=0,i=this,n=i.view.doc;n.iter(0,n.size,function(n){n.gutterMarkers&&n.gutterMarkers[t]&&(n.gutterMarkers[t]=null,q(i,e,e+1),sn(n.gutterMarkers)&&(n.gutterMarkers=null)),++e})}),addLineClass:U(null,function(t,e,i){return ze(this,t,function(t){var n="text"==e?"textClass":"background"==e?"bgClass":"wrapClass";if(t[n]){if(new RegExp("\\b"+i+"\\b").test(t[n]))return!1;t[n]+=" "+i}else t[n]=i;return!0})}),removeLineClass:U(null,function(t,e,i){return ze(this,t,function(t){var n="text"==e?"textClass":"background"==e?"bgClass":"wrapClass",r=t[n];if(!r)return!1;if(null==i)t[n]=null;else{var o=r.replace(new RegExp("^"+i+"\\b\\s*|\\s*\\b"+i+"\\b"),"");if(o==r)return!1;t[n]=o||null}return!0})}),addLineWidget:U(null,function(t,e,i){var n=i||{};return n.node=e,n.noHScroll&&(this.display.alignWidgets=!0),ze(this,t,function(t){return(t.widgets||(t.widgets=[])).push(n),n.line=t,!0}),n}),removeLineWidget:U(null,function(t){var e=t.line.widgets,i=Oi(t.line);if(null!=i){for(var n=0;n<e.length;++n)e[n]==t&&e.splice(n--,1);q(this,i,i+1)}}),lineInfo:function(t){if("number"==typeof t){if(!Ae(this.view.doc,t))return null;var e=t;if(t=Ai(this.view.doc,t),!t)return null}else{var e=Oi(t);if(null==e)return null}return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(t,e,i,n,r){var o=this.display;t=z(this,Le(this.view.doc,t));var a=t.top,s=t.left;if(e.style.position="absolute",o.sizer.appendChild(e),"over"==n)a=t.top;else if("near"==n){var l=Math.max(o.wrapper.clientHeight,this.view.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);t.bottom+e.offsetHeight>l&&t.top>e.offsetHeight&&(a=t.top-e.offsetHeight),s+e.offsetWidth>c&&(s=c-e.offsetWidth)}e.style.top=a+O(o)+"px",e.style.left=e.style.right="","right"==r?(s=o.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==r?s=0:"middle"==r&&(s=(o.sizer.clientWidth-e.offsetWidth)/2),e.style.left=s+"px"),i&&We(this,s,a,s+e.offsetWidth,a+e.offsetHeight)},lineCount:function(){return this.view.doc.size},clipPos:function(t){return Le(this.view.doc,t)},getCursor:function(t){var e,i=this.view.sel;return e=null==t||"head"==t?i.head:"anchor"==t?i.anchor:"end"==t||t===!1?i.to:i.from,Me(e)},somethingSelected:function(){return!Se(this.view.sel.from,this.view.sel.to)},setCursor:U(null,function(t,e,i){var n=Le(this.view.doc,"number"==typeof t?{line:t,ch:e||0}:t);i?Ee(this,n):Oe(this,n,n)}),setSelection:U(null,function(t,e){var i=this.view.doc;Oe(this,Le(i,t),Le(i,e||t))}),extendSelection:U(null,function(t,e){var i=this.view.doc;Ee(this,Le(i,t),e&&Le(i,e))}),setExtending:function(t){this.view.sel.extend=t},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){var e=this.view.doc;return Ae(e,t)?Ai(e,t):void 0},getLineNumber:function(t){return Oi(t)},setLine:U(null,function(t,e){Ae(this.view.doc,t)&&ke(this,e,{line:t,ch:0},{line:t,ch:Ai(this.view.doc,t).text.length})}),removeLine:U(null,function(t){Ae(this.view.doc,t)&&ke(this,"",{line:t,ch:0},Le(this.view.doc,{line:t+1,ch:0}))}),replaceRange:U(null,function(t,e,i){var n=this.view.doc;return e=Le(n,e),i=i?Le(n,i):e,ke(this,t,e,i)}),getRange:function(t,e,i){var n=this.view.doc;t=Le(n,t),e=Le(n,e);var r=t.line,o=e.line;if(r==o)return Ai(n,r).text.slice(t.ch,e.ch);var a=[Ai(n,r).text.slice(t.ch)];return n.iter(r+1,o,function(t){a.push(t.text)}),a.push(Ai(n,o).text.slice(0,e.ch)),a.join(i||"\n")},triggerOnKeyDown:U(null,me),execCommand:function(t){return ar[t](this)},moveH:U(null,function(t,e){var i=this.view.sel,n=0>t?i.from:i.to;(i.shift||i.extend||Se(i.from,i.to))&&(n=Fe(this,t,e,!0)),Ee(this,n,n,t)}),deleteH:U(null,function(t,e){var i=this.view.sel;Se(i.from,i.to)?ke(this,"",i.from,Fe(this,t,e,!1),"delete"):ke(this,"",i.from,i.to,"delete"),this.curOp.userSelChange=!0}),moveV:U(null,function(t,e){var i,n=this.view,r=n.doc,o=this.display,a=n.sel.head,s=z(this,a,"div"),l=s.left;if(null!=n.goalColumn&&(l=n.goalColumn),"page"==e){var c=Math.min(o.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=s.top+t*c}else"line"==e&&(i=t>0?s.bottom+3:s.top-3);do{var d=F(this,l,i);i+=5*t}while(d.outside&&(0>t?i>0:i<r.height));"page"==e&&(o.scrollbarV.scrollTop+=I(this,d,"div").top-s.top),Ee(this,d,d,t),n.goalColumn=l}),toggleOverwrite:function(){(this.view.overwrite=!this.view.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},posFromIndex:function(t){var e,i=0,n=this.view.doc;return n.iter(0,n.size,function(n){var r=n.text.length+1;return r>t?(e=t,!0):(t-=r,void++i)}),Le(n,{line:i,ch:e})},indexFromPos:function(t){if(t.line<0||t.ch<0)return 0;var e=t.ch;return this.view.doc.iter(0,t.line,function(t){e+=t.text.length+1}),e},scrollTo:function(t,e){null!=t&&(this.display.scrollbarH.scrollLeft=this.display.scroller.scrollLeft=t),null!=e&&(this.display.scrollbarV.scrollTop=this.display.scroller.scrollTop=e),_(this,[])
},getScrollInfo:function(){var t=this.display.scroller,e=dr;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-e,width:t.scrollWidth-e,clientHeight:t.clientHeight-e,clientWidth:t.clientWidth-e}},scrollIntoView:function(t){"number"==typeof t&&(t={line:t,ch:0}),t=t?Le(this.view.doc,t):this.view.sel.head,Be(this,t)},setSize:function(t,e){function i(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t}null!=t&&(this.display.wrapper.style.width=i(t)),null!=e&&(this.display.wrapper.style.height=i(e)),this.refresh()},on:function(t,e){Gi(this,t,e)},off:function(t,e){Ui(this,t,e)},operation:function(t){return U(this,t)()},refresh:function(){W(this),this.display.scroller.scrollHeight>this.view.scrollTop&&(this.display.scrollbarV.scrollTop=this.display.scroller.scrollTop=this.view.scrollTop),_(this,!0)},getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var Qn=t.optionHandlers={},tr=t.defaults={},er=t.Init={toString:function(){return"CodeMirror.Init"}};Ye("value","",function(t,e){t.setValue(e)},!0),Ye("mode",null,n,!0),Ye("indentUnit",2,n,!0),Ye("indentWithTabs",!1),Ye("smartIndent",!0),Ye("tabSize",4,function(t){n(t),W(t),_(t,!0)},!0),Ye("electricChars",!0),Ye("theme","default",function(t){a(t),s(t)},!0),Ye("keyMap","default",o),Ye("extraKeys",null),Ye("onKeyEvent",null),Ye("onDragEvent",null),Ye("lineWrapping",!1,r,!0),Ye("gutters",[],function(t){u(t.options),s(t)},!0),Ye("lineNumbers",!1,function(t){u(t.options),s(t)},!0),Ye("firstLineNumber",1,s,!0),Ye("lineNumberFormatter",function(t){return t},s,!0),Ye("showCursorWhenSelecting",!1,k,!0),Ye("readOnly",!1,function(t,e){"nocursor"==e?(_e(t),t.display.input.blur()):e||J(t,!0)}),Ye("dragDrop",!0),Ye("cursorBlinkRate",530),Ye("cursorHeight",1),Ye("workTime",100),Ye("workDelay",100),Ye("flattenSpans",!0),Ye("pollInterval",100),Ye("undoDepth",40),Ye("viewportMargin",10,function(t){t.refresh()},!0),Ye("tabindex",null,function(t,e){t.display.input.tabIndex=e||""}),Ye("autofocus",null);var ir=t.modes={},nr=t.mimeModes={};t.defineMode=function(e,i){if(t.defaults.mode||"null"==e||(t.defaults.mode=e),arguments.length>2){i.dependencies=[];for(var n=2;n<arguments.length;++n)i.dependencies.push(arguments[n])}ir[e]=i},t.defineMIME=function(t,e){nr[t]=e},t.resolveMode=function(e){if("string"==typeof e&&nr.hasOwnProperty(e))e=nr[e];else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return t.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},t.getMode=function(e,i){var i=t.resolveMode(i),n=ir[i.name];if(!n)return t.getMode(e,"text/plain");var r=n(e,i);if(rr.hasOwnProperty(i.name)){var o=rr[i.name];for(var a in o)o.hasOwnProperty(a)&&(r.hasOwnProperty(a)&&(r["_"+a]=r[a]),r[a]=o[a])}return r.name=i.name,r},t.defineMode("null",function(){return{token:function(t){t.skipToEnd()}}}),t.defineMIME("text/plain","null");var rr=t.modeExtensions={};t.extendMode=function(t,e){var i=rr.hasOwnProperty(t)?rr[t]:rr[t]={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n])},t.defineExtension=function(e,i){t.prototype[e]=i},t.defineOption=Ye;var or=[];t.defineInitHook=function(t){or.push(t)},t.copyState=Ve,t.startState=Ge,t.innerMode=function(t,e){for(;t.innerMode;){var i=t.innerMode(e);e=i.state,t=i.mode}return i||{mode:t,state:e}};var ar=t.commands={selectAll:function(t){t.setSelection({line:0,ch:0},{line:t.lineCount()-1})},killLine:function(t){var e=t.getCursor(!0),i=t.getCursor(!1),n=!Se(e,i);n||t.getLine(e.line).length!=e.ch?t.replaceRange("",e,n?i:{line:e.line},"delete"):t.replaceRange("",e,{line:e.line+1,ch:0},"delete")},deleteLine:function(t){var e=t.getCursor().line;t.replaceRange("",{line:e,ch:0},{line:e},"delete")},undo:function(t){t.undo()},redo:function(t){t.redo()},goDocStart:function(t){t.extendSelection({line:0,ch:0})},goDocEnd:function(t){t.extendSelection({line:t.lineCount()-1})},goLineStart:function(t){t.extendSelection(vn(t,t.getCursor().line))},goLineStartSmart:function(t){var e=t.getCursor(),i=vn(t,e.line),n=t.getLineHandle(i.line),r=$i(n);if(r&&0!=r[0].level)t.extendSelection(i);else{var o=Math.max(0,n.text.search(/\S/)),a=e.line==i.line&&e.ch<=o&&e.ch;t.extendSelection({line:i.line,ch:a?0:o})}},goLineEnd:function(t){t.extendSelection(bn(t,t.getCursor().line))},goLineUp:function(t){t.moveV(-1,"line")},goLineDown:function(t){t.moveV(1,"line")},goPageUp:function(t){t.moveV(-1,"page")},goPageDown:function(t){t.moveV(1,"page")},goCharLeft:function(t){t.moveH(-1,"char")},goCharRight:function(t){t.moveH(1,"char")},goColumnLeft:function(t){t.moveH(-1,"column")},goColumnRight:function(t){t.moveH(1,"column")},goWordLeft:function(t){t.moveH(-1,"word")},goWordRight:function(t){t.moveH(1,"word")},delCharBefore:function(t){t.deleteH(-1,"char")},delCharAfter:function(t){t.deleteH(1,"char")},delWordBefore:function(t){t.deleteH(-1,"word")},delWordAfter:function(t){t.deleteH(1,"word")},indentAuto:function(t){t.indentSelection("smart")},indentMore:function(t){t.indentSelection("add")},indentLess:function(t){t.indentSelection("subtract")},insertTab:function(t){t.replaceSelection("	","end","input")},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.replaceSelection("	","end","input")},transposeChars:function(t){var e=t.getCursor(),i=t.getLine(e.line);e.ch>0&&e.ch<i.length-1&&t.replaceRange(i.charAt(e.ch)+i.charAt(e.ch-1),{line:e.line,ch:e.ch-1},{line:e.line,ch:e.ch+1})},newlineAndIndent:function(t){U(t,function(){t.replaceSelection("\n","end","input"),t.indentLine(t.getCursor().line,null,!0)})()},toggleOverwrite:function(t){t.toggleOverwrite()}},sr=t.keyMap={};sr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},sr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordBefore","Ctrl-Delete":"delWordAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},sr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordBefore","Ctrl-Alt-Backspace":"delWordAfter","Alt-Delete":"delWordAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},sr["default"]=Vn?sr.macDefault:sr.pcDefault,sr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},t.isModifierKey=Ke,t.fromTextArea=function(e,i){function n(){e.value=l.getValue()}if(i||(i={}),i.value=e.value,!i.tabindex&&e.tabindex&&(i.tabindex=e.tabindex),null==i.autofocus){var r=document.body;try{r=document.activeElement}catch(o){}i.autofocus=r==e||null!=e.getAttribute("autofocus")&&r==document.body}if(e.form){Gi(e.form,"submit",n);var a=e.form,s=a.submit;try{a.submit=function c(){n(),a.submit=s,a.submit(),a.submit=c}}catch(o){}}e.style.display="none";var l=t(function(t){e.parentNode.insertBefore(t,e.nextSibling)},i);return l.save=n,l.getTextArea=function(){return e},l.toTextArea=function(){n(),e.parentNode.removeChild(l.getWrapperElement()),e.style.display="",e.form&&(Ui(e.form,"submit",n),"function"==typeof e.form.submit&&(e.form.submit=s))},l},Xe.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(t){var e=this.string.charAt(this.pos);if("string"==typeof t)var i=e==t;else var i=e&&(t.test?t.test(e):t(e));return i?(++this.pos,e):void 0},eatWhile:function(t){for(var e=this.pos;this.eat(t););return this.pos>e},eatSpace:function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(t){var e=this.string.indexOf(t,this.pos);return e>-1?(this.pos=e,!0):void 0},backUp:function(t){this.pos-=t},column:function(){return Ji(this.string,this.start,this.tabSize)},indentation:function(){return Ji(this.string,null,this.tabSize)},match:function(t,e,i){if("string"!=typeof t){var n=this.string.slice(this.pos).match(t);return n&&n.index>0?null:(n&&e!==!1&&(this.pos+=n[0].length),n)}var r=function(t){return i?t.toLowerCase():t};return r(this.string).indexOf(r(t),this.pos)==this.pos?(e!==!1&&(this.pos+=t.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},t.StringStream=Xe,Ze.prototype.clear=function(){if(!this.explicitlyCleared){V(this.cm);for(var t=null,e=null,i=0;i<this.lines.length;++i){var n=this.lines[i],r=Qe(n.markedSpans,this);null!=r.to&&(e=Oi(n)),n.markedSpans=ti(n.markedSpans,r),null!=r.from?t=Oi(n):this.collapsed&&!di(n)&&Ei(n,R(this.cm.display))}null!=t&&q(this.cm,t,e+1),this.lines.length=0,this.explicitlyCleared=!0,this.collapsed&&this.cm.view.cantEdit&&(this.cm.view.cantEdit=!1,Ne(this.cm)),G(this.cm),Ki(this.cm,this,"clear")}},Ze.prototype.find=function(){for(var t,e,i=0;i<this.lines.length;++i){var n=this.lines[i],r=Qe(n.markedSpans,this);if(null!=r.from||null!=r.to){var o=Oi(n);null!=r.from&&(t={line:o,ch:r.from}),null!=r.to&&(e={line:o,ch:r.to})}}return"bookmark"==this.type?t:t&&{from:t,to:e}},window.lineIsHidden=di;var lr={},cr=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g;Ti.prototype={chunkSize:function(){return this.lines.length},remove:function(t,e,i){for(var n=t,r=t+e;r>n;++n){var o=this.lines[n];this.height-=o.height,vi(o),Ki(i,o,"delete")}this.lines.splice(t,e)},collapse:function(t){t.splice.apply(t,[t.length,0].concat(this.lines))},insertHeight:function(t,e,i){this.height+=i,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var n=0,r=e.length;r>n;++n)e[n].parent=this},iterN:function(t,e,i){for(var n=t+e;n>t;++t)if(i(this.lines[t]))return!0}},Li.prototype={chunkSize:function(){return this.size},remove:function(t,e,i){this.size-=e;for(var n=0;n<this.children.length;++n){var r=this.children[n],o=r.chunkSize();if(o>t){var a=Math.min(e,o-t),s=r.height;if(r.remove(t,a,i),this.height-=s-r.height,o==a&&(this.children.splice(n--,1),r.parent=null),0==(e-=a))break;t=0}else t-=o}if(this.size-e<25){var l=[];this.collapse(l),this.children=[new Ti(l)],this.children[0].parent=this}},collapse:function(t){for(var e=0,i=this.children.length;i>e;++e)this.children[e].collapse(t)},insert:function(t,e){for(var i=0,n=0,r=e.length;r>n;++n)i+=e[n].height;this.insertHeight(t,e,i)},insertHeight:function(t,e,i){this.size+=e.length,this.height+=i;for(var n=0,r=this.children.length;r>n;++n){var o=this.children[n],a=o.chunkSize();if(a>=t){if(o.insertHeight(t,e,i),o.lines&&o.lines.length>50){for(;o.lines.length>50;){var s=o.lines.splice(o.lines.length-25,25),l=new Ti(s);o.height-=l.height,this.children.splice(n+1,0,l),l.parent=this}this.maybeSpill()}break}t-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),i=new Li(e);if(t.parent){t.size-=i.size,t.height-=i.height;var n=nn(t.parent.children,t);t.parent.children.splice(n+1,0,i)}else{var r=new Li(t.children);r.parent=t,t.children=[r,i],t=r}i.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iter:function(t,e,i){this.iterN(t,e-t,i)},iterN:function(t,e,i){for(var n=0,r=this.children.length;r>n;++n){var o=this.children[n],a=o.chunkSize();if(a>t){var s=Math.min(e,a-t);if(o.iterN(t,s,i))return!0;if(0==(e-=s))break;t=0}else t-=a}}},t.e_stop=Hi,t.e_preventDefault=zi,t.e_stopPropagation=Fi,t.on=Gi,t.off=Ui,t.signal=qi;var dr=30,ur=t.Pass={toString:function(){return"CodeMirror.Pass"}};Zi.prototype={set:function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)}},t.countColumn=Ji;var fr=[""],pr=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,hr=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F]/,mr=function(){if(Nn)return!1;var t=ln("div");return"draggable"in t||"dragDrop"in t}(),gr=/^$/;An?gr=/$'/:Pn?gr=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:Bn&&(gr=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);var yr,_r,vr=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,i=[],n=t.length;n>=e;){var r=t.indexOf("\n",e);-1==r&&(r=t.length);var o=t.slice(e,"\r"==t.charAt(r-1)?r-1:r),a=o.indexOf("\r");-1!=a?(i.push(o.slice(0,a)),e+=a+1):(i.push(o),e=r+1)}return i}:function(t){return t.split(/\r\n?|\n/)};t.splitLines=vr;var br=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(e){return!1}}:function(t){try{var e=t.ownerDocument.selection.createRange()}catch(i){}return e&&e.parentElement()==t?0!=e.compareEndPoints("StartToEnd",e):!1},xr=function(){var t=ln("div");return"oncopy"in t?!0:(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)}(),wr={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};t.keyNames=wr,function(){for(var t=0;10>t;t++)wr[t+48]=String(t);for(var t=65;90>=t;t++)wr[t]=String.fromCharCode(t);for(var t=1;12>=t;t++)wr[t+111]=wr[t+63235]="F"+t}();var Cr=function(){function t(t){return 255>=t?e.charAt(t):t>=1424&&1524>=t?"R":t>=1536&&1791>=t?i.charAt(t-1536):t>=1792&&2220>=t?"r":"L"}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",i="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",n=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,o=/[LRr]/,a=/[Lb1n]/,s=/[1n]/;return function(e){if(!n.test(e))return!1;for(var i,l=e.length,c=[],d=null,u=0;l>u;++u)c.push(i=t(e.charCodeAt(u))),null==d&&("L"==i?d="L":("R"==i||"r"==i)&&(d="R"));null==d&&(d="L");for(var u=0,f=d;l>u;++u){var i=c[u];"m"==i?c[u]=f:f=i}for(var u=0,p=d;l>u;++u){var i=c[u];"1"==i&&"r"==p?c[u]="n":o.test(i)&&(p=i,"r"==i&&(c[u]="R"))}for(var u=1,f=c[0];l-1>u;++u){var i=c[u];"+"==i&&"1"==f&&"1"==c[u+1]?c[u]="1":","!=i||f!=c[u+1]||"1"!=f&&"n"!=f||(c[u]=f),f=i}for(var u=0;l>u;++u){var i=c[u];if(","==i)c[u]="N";else if("%"==i){for(var h=u+1;l>h&&"%"==c[h];++h);for(var m=u&&"!"==c[u-1]||l-1>h&&"1"==c[h]?"1":"N",g=u;h>g;++g)c[g]=m;u=h-1}}for(var u=0,p=d;l>u;++u){var i=c[u];"L"==p&&"1"==i?c[u]="L":o.test(i)&&(p=i)}for(var u=0;l>u;++u)if(r.test(c[u])){for(var h=u+1;l>h&&r.test(c[h]);++h);for(var y="L"==(u?c[u-1]:d),_="L"==(l-1>h?c[h]:d),m=y||_?"L":"R",g=u;h>g;++g)c[g]=m;u=h-1}for(var v,b=[],u=0;l>u;)if(a.test(c[u])){var x=u;for(++u;l>u&&a.test(c[u]);++u);b.push({from:x,to:u,level:0})}else{var w=u,C=b.length;for(++u;l>u&&"L"!=c[u];++u);for(var g=w;u>g;)if(s.test(c[g])){g>w&&b.splice(C,0,{from:w,to:g,level:1});var k=g;for(++g;u>g&&s.test(c[g]);++g);b.splice(C,0,{from:k,to:g,level:2}),w=g}else++g;u>w&&b.splice(C,0,{from:w,to:u,level:1})}return 1==b[0].level&&(v=e.match(/^\s+/))&&(b[0].from=v[0].length,b.unshift({from:0,to:v[0].length,level:0})),1==tn(b).level&&(v=e.match(/\s+$/))&&(tn(b).to-=v[0].length,b.push({from:l-v[0].length,to:l,level:0})),b[0].level!=tn(b).level&&b.push({from:l,to:l,level:b[0].level}),b}}();return t.version="3.0",t}();