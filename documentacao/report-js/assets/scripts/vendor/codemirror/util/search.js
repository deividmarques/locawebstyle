!function(){function t(){this.posFrom=this.posTo=this.query=null,this.marked=[]}function e(e){return e._searchState||(e._searchState=new t)}function i(t,e,i){return t.getSearchCursor(e,i,"string"==typeof e&&e==e.toLowerCase())}function a(t,e,i,a){t.openDialog?t.openDialog(e,a):a(prompt(i,""))}function s(t,e,i,a){t.openConfirm?t.openConfirm(e,a):confirm(i)&&a[0]()}function o(t){var e=t.match(/^\/(.*)\/([a-z]*)$/);return e?new RegExp(e[1],-1==e[2].indexOf("i")?"":"i"):t}function n(t,s){var n=e(t);return n.query?r(t,s):void a(t,d,"Search for:",function(e){t.operation(function(){if(e&&!n.query){if(n.query=o(e),t.lineCount()<2e3)for(var a=i(t,n.query);a.findNext();)n.marked.push(t.markText(a.from(),a.to(),{className:"CodeMirror-searching"}));n.posFrom=n.posTo=t.getCursor(),r(t,s)}})})}function r(t,a){t.operation(function(){var s=e(t),o=i(t,s.query,a?s.posFrom:s.posTo);(o.find(a)||(o=i(t,s.query,a?{line:t.lineCount()-1}:{line:0,ch:0}),o.find(a)))&&(t.setSelection(o.from(),o.to()),s.posFrom=o.from(),s.posTo=o.to())})}function l(t){t.operation(function(){var i=e(t);if(i.query){i.query=null;for(var a=0;a<i.marked.length;++a)i.marked[a].clear();i.marked.length=0}})}function c(t,e){a(t,p,"Replace:",function(n){n&&(n=o(n),a(t,f,"Replace with:",function(a){function o(){var e,a=c.from();!(e=c.findNext())&&(c=i(t,n),!(e=c.findNext())||a&&c.from().line==a.line&&c.from().ch==a.ch)||(t.setSelection(c.from(),c.to()),s(t,u,"Replace?",[function(){r(e)},o]))}function r(t){c.replace("string"==typeof n?a:a.replace(/\$(\d)/,function(e,i){return t[i]})),o()}if(e)t.operation(function(){for(var e=i(t,n);e.findNext();)if("string"!=typeof n){var s=t.getRange(e.from(),e.to()).match(n);e.replace(a.replace(/\$(\d)/,function(t,e){return s[e]}))}else e.replace(a)});else{l(t);var c=i(t,n,t.getCursor());o()}}))})}var d='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',p='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',f='With: <input type="text" style="width: 10em"/>',u="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(t){l(t),n(t)},CodeMirror.commands.findNext=n,CodeMirror.commands.findPrev=function(t){n(t,!0)},CodeMirror.commands.clearSearch=l,CodeMirror.commands.replace=c,CodeMirror.commands.replaceAll=function(t){c(t,!0)}}();